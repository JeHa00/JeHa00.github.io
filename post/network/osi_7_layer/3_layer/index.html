<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[TIL]OSI 7 layer: 3계층 네트워크 계층 | Jeha DevLog</title><meta name=keywords content="TIL,Network"><meta name=description content="OSI 7 layer에서 한 네트워크에서 다른 네트워크와 통신하기 위한 IP 주소를 결정하는 3계층에 대해 더 알아보자."><meta name=author content><link rel=canonical href=http://jeha00.github.io/post/network/osi_7_layer/3_layer/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.268b216eea772711d318d156ce02a8190962367a0bf469fa9a959114ea6b9ca3.css integrity="sha256-Joshbup3JxHTGNFWzgKoGQliNnoL9Gn6mpWRFOprnKM=" rel="preload stylesheet" as=style><link rel=icon href=http://jeha00.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://jeha00.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://jeha00.github.io/favicon-32x32.png><link rel=apple-touch-icon href=http://jeha00.github.io/apple-touch-icon.png><link rel=mask-icon href=http://jeha00.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="[TIL]OSI 7 layer: 3계층 네트워크 계층"><meta property="og:description" content="OSI 7 layer에서 한 네트워크에서 다른 네트워크와 통신하기 위한 IP 주소를 결정하는 3계층에 대해 더 알아보자."><meta property="og:type" content="article"><meta property="og:url" content="http://jeha00.github.io/post/network/osi_7_layer/3_layer/"><meta property="og:image" content="http://jeha00.github.io/47"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-05-24T15:14:44+09:00"><meta property="article:modified_time" content="2023-05-24T15:14:44+09:00"><meta property="og:site_name" content="JeHa00 DevLog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://jeha00.github.io/47"><meta name=twitter:title content="[TIL]OSI 7 layer: 3계층 네트워크 계층"><meta name=twitter:description content="OSI 7 layer에서 한 네트워크에서 다른 네트워크와 통신하기 위한 IP 주소를 결정하는 3계층에 대해 더 알아보자."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://jeha00.github.io/post/"},{"@type":"ListItem","position":2,"name":"[TIL]OSI 7 layer: 3계층 네트워크 계층","item":"http://jeha00.github.io/post/network/osi_7_layer/3_layer/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[TIL]OSI 7 layer: 3계층 네트워크 계층","name":"[TIL]OSI 7 layer: 3계층 네트워크 계층","description":"OSI 7 layer에서 한 네트워크에서 다른 네트워크와 통신하기 위한 IP 주소를 결정하는 3계층에 대해 더 알아보자.","keywords":["TIL","Network"],"articleBody":"네트워크 학습 내용 순서 [TIL]Web Application Basic study: OSI 7 layer outline [TIL] Network OSI 7 layer: 1계층 [TIL] Network OSI 7 layer: 2계층 이번 장에서는 네트워크(Network) 계층인 3계층에 대해 알아보자.\n1. IP(Internet Protocol) 네트워크 계층 개요 네트워크 계층은 한 네트워크와 다른 네트워크 간 통신하기 위해 IP를 결정하는 계층 으로, 사용하는 ‘주요 프로토콜’은 IP(Internet Protocol) 를 사용한다. ‘주요 네트워크 기기’는 라우터 이며, ‘주요 데이터 단위’ 는 packet 이다.\n네트워크 계층의 특징은 아래 4가지로 요약할 수 있다.\n비신뢰성 데이터가 송신지까지 도달하는 걸 보장하지 않는다. 그래서 인터넷 계층의 윗 계층인 4계층 전송 계층에서 이를 갖춘다. 그래서 데이터 순서가 바뀔 수도 있고, 서로 다른 경로를 통해 전송될 수 있다.\n비연결형 4계층 전송 계층과는 달리 연결설정 과정 없이 데이터를 전송한다.\n주소 지정 IP 주소를 제공하여 각 기기 장치가 식별될 수 있도록 하는 역할을 한다. MAC 주소는 컴퓨터의 물리적인 식별자라면 IP 주소는 인터넷 연결 간 논리적인 식별을 하는데 사용된다.\n경로 결정 이 IP 주소를 통해 라우팅의 경로 설정도 가능하다.\n2. IP 주소 IP 주소란? 그리고 IP 주소의 사용 목적 각 기기들을 식별하기 위한 논리적인 주소를 말한다. 네트워크에 연결되어 있는 기기(호스트나 라우터)들은 자신의 고유한 주소를 갖고 있어야 데이터를 주고 받을 수 있다. 이를 위해서 인터넷 프로토콜은 논리적인 주소인 IP 주소를 제공하여 데이터를 서로 송수신할 수 있게 한다.\nIPv6 버전은 IPv4를 대체하기 위해 등장 IPv4 에서 4는 . 으로 나눠진 부분이 4군데여서 그렇다는 게 아닌 IP 를 표시하는 게 4세대 버전이라는 의미다. IPv6는 6세대 버전이라는 의미.\nIPv4: Internet Protocol version 4 IPv6: Internet Protocol version 6 IPv4 IPv6 주소 형식 192.168.10.1 FE80:CD00:0000:0CDE:1257:0000:211E:729C 주소 표현 10진수 16진수 크기 32bit(4 bytes) 128bit(16 bytes) 최대 표현 개수 약 43억개 범위: 0.0.0.0 ~ 255.255.255.255 무한대에 가깝다. 서비스 품질 제한적 품질 확장된 품질 보안 기능 IPSec 별도 설치 기본 제공 크기\nIPv4 기준으로 각각 8bit씩 총 4 부분 * 8bit = 32bit를 이룬다. IPv6 기준으로 각각 8bit씩 총 8 부분 * 16bit = 128bit를 이룬다. 8bit를 1 옥텟(octet)이라 부른다.\nNetwork ID와 Host ID 범위에 따라 Network ID와 Host ID로 구분할 수 있다.\n네트워크 ID: 전체 중 작은 네트워크를 식별하는 ID이자 호스트의 집합 대표 주소\n호스트 ID: 호스트를 식별\nIP 주소 클래스 (IPv4 기준) 클래스 IPv4 (2진수) IPv4 (10진수) 네트워크 ID 호스트 ID 비고 A 00000001. 00000000. 00000000. 00000000 0.0.0.0 ~ 127.255.255.255 8 bit 24 bit B 10000000. 00000000. 00000000. 00000000 128 .0.0.0 ~ 191.255.255.255 16 bit 16 bit C 11000000. 00000000. 00000000. 00000000 192 .0.0.0 ~ 223.255.255.255 24bit 8 bit D 11100000. 00000000. 00000000. 00000000 224.0.0.0 ~ 239.255.255.255 멀티캐스트용 E 11110000. 00000000. 00000000. 00000000 240.0.0.0 ~ 239.255.255.255 특수용도 예약주소 docker IP는 B 클래스에 해당된다. MAC 주소와 비교 MAC 주소: 48 bit, 16진수 IP 주소 (IPv4): 32 bit, 2진수 실제로는 2진수로 되어 있고, 사람이 보기 편하게 10진수로 되어 있다. A, B class의 문제점과 해결책 A 클래스와 B 클래스는 하나의 IP 주소로 많은 호스트를 가질 수 있다. 그런데 한 기관에서 이렇게 많은 호스트를 가지게 되는 경우는 없기 때문에, IP 주소가 낭비되는 문제가 발생된다. 또한, 이렇게 많은 컴퓨터가 패킷을 보내면 네트워크가 혼잡해진다. 이러한 문제점을 해결하는 방법이 이어서 학습할 내용인 “서브넷팅” 이다.\n3. Subnetting(서브넷팅) Subnetting, Subnet(서브넷), Subnet mask(서브넷 마스크) 란? 서브넷팅(subnetting) 이란 IP 주소를 클래스로 구분하는 방법으로, 네트워크를 작은 네트워크로 분할하여 너무 많은 IP 주소들이 낭비되는 문제를 해결하기 위한 기술이다. 이 분할된 네트워크를 Subnet(서브넷) 이라고 부른다. 서브넷들의 IP에서 어디까지가 네트워크 ID이고 호스트 ID인지 식별하기가 어려운데, 이를 돕는 게 바로 Subnet mask(서브넷 마스크) 이다. 네트워크 ID와 호스트 ID를 식별하기 위해서, 네트워크 ID에 해당되는 부분을 모두 1로, 호스트 ID에 해당하는 부분을 모두 0으로 표기하는 형식을 말한다.\n클래스별 서브넷 마스크 그래서 서브넷 마스크를 클래스 별로 표시하자면 다음과 같다.\n클래스 IPv4 (2진수) IPv4 (10진수) 프리픽스 표기법 A 255.0.0.0 11111111 00000000 00000000 00000000 /8 B 255.255.0.0 11111111 11111111 00000000 00000000 /16 c 255.255.255.0 11111111 11111111 11111111 00000000 /24 🔆 프리픽스 표기법: 서브넷 마스크를 슬래시 비트 수로 나타낸 것으로, 네트워크 ID 부분을 나타낸다.\n그래서 255.255.255.240인 경우, 8bit 3개에 4bit를 더해서 /28 로 표기한다.\n4. IP packet 과 header 역캡슐화의 관점에서 packet이란? 네트워크 계층보다 더 아래에 있는 데이터 링크 계층에서는 데이터 단위를 ‘프레임(frame)‘을 사용한다. 이 프레임에서 역캡슐화를 통해 이더넷 헤더와 트레일러를 제거한 것이 네트워크 계층에서의 프로토콜 데이터 단위인 ‘패킷(packet)‘이 된다.\n캡슐화의 관점에서 packet이란? 또 네트워크 계층보다 위 계층의 데이터 단위인 TCP 세그먼트에서 캡슐화해서 IP 헤더를 붙인 것도 ‘패킷(packet)‘이다.\nIP packet header에는 어떤 정보가 담겨져 있는가? (IPv4 기준) 데이터를 전달하기 위한 정보들이 포함되어 있다. 이 정보들을 사용하여 네트워크 계층의 장비인 라우터가 라우팅 동작을 하는데 핵심적인 역할을 수행한다.\n5. Router 가정 내에의 네트워크(LAN)에서 인터넷 네트워크(WAN)로 접속하기 위해서는 라우터가 필요하다. 그 이유는 이 라우터에는 ISP(ex: KT, SK telecom, LG U+)를 통해서 공인 IP를 부여받은 라우터를 거쳐야하기 때문이다.\nRouter의 역할 라우터는 위 내용을 보다 일반화해서 표현하자면 ‘한’ 네트워크에서 ‘다른’ 네트워크로 데이터를 보내는 역할 을 한다.\n그러면 네트워크 계층보다 하위 계층인 데이터 링크 계층의 장비인 스위치부터 다시 생각해보자.\n스위치에 연결된 장비들은 같은 네트워크 범위에 있다. 그런데 네트워크를 통해 데이터를 보낼 때 반드시 동일한 네트워크 범위 내로만 보내는 게 아니다. 다른 네트워크에 있는 곳으로도 데이터를 보내야 한다. 이 때 이 네트워크 계층을 지나야하고, 이 계층에서의 장비가 ‘라우터’다. 이 라우터를 지나면 바로 다른 네트워크 로 갈 수 있지만, 때로는 목적지 네트워크에 도달하기 위해 해당 네트워크와 보다 가까운 ‘다른 라우터’를 판단 하기도 한다.\n아래 이미지를 통해 보다 자세히 알아보자.\nNetwork 1과 Network 3 사이에는 Network 2가 존재한다. Router 1은 network 1 뿐만 아니라 network 2에도 연결이 되어 있다. 복수의 인터페이스를 제공하며 이에 맞는 물리적 배선과 IP 주소가 설정되어 있다. 그래서 라우터에는 각 네트워크마다 연결되어 있어서 여러 IP 주소를 가진다.\nRouting 과 Routing table 그렇다면 라우터는 다른 네트워크로 가는 경로를 어떻게 아는 것일까? 이에 대한 답은 바로 ‘라우팅 테이블’ 에 있다. 위 이미지 양 끝단에 Router 1과 Router 2에 대한 라우팅 테이블이 존재한다.\n라우팅 테이블에 대해 간략히 설명하기에 앞서 ‘라우팅’ 이란 단어에 대해 알아보자.\n라우팅 이란 패킷을 목적지 IP까지 최적의 경로로 전송할 수 있도록 이 경로를 찾는 동작을 말한다. 이 라우팅을 하기 위해서는 경로에 대한 정보를 라우터가 가지고 있어야 가능하다. 그 정보가 등록되고 관리되는 테이블이 라우팅 테이블 이다. 라우팅 하기 위해 라우팅 테이블을 이용한다.\n라우터에서 MAC 주소와 IP 주소 MAC 주소는 우리가 사용하는 desktop, labtop 뿐만 아니라 스위치와 라우터도 포함하여 각 장치마다 부여된 고유의 물리적인 주소다. MAC 주소는 랜카드에 탑재되어 있고, 랜카드(LAN card 또는 Network Interface Card, NIC)는 각 기기마다 존재하기 때문이다.\n다른 네트워크에 전달하기 위해서는 여러 기기들을 전송 도중에 거쳐야하기 때문에 라우터를 거치면 도착지 MAC 주소와 출발지 MAC 주소를 바꿔가며 전송하게 된다. 즉 프레임 데이터의 관점에서 보자면 이더넷헤더와 FCS(트레일러)가 교체된다는 의미다. 다음으로 전송해야할 MAC 주소를 알아내기 위해서 ‘ARP’ 라는 다른 프로토콜을 사용한다.\n하지만, IP 헤더의 경우 NAT 주소 변환 시를 제외하고는 도착지 IP와 출발지 IP 주소는 변하지 않고, TTL과 헤더 체크섬이 변경된다.\n라우터 간의 통신 🔆 그렇다면 라우터 간 통신은 어떻게 하는 걸까?\n출처: 네트워크 전반적인 과정에 대해 문의드립니다. 위 출처에 따르자면 한 라우터에 다른 라우터로 이동할 때 라우터마다 내부적으로 물리 계층 - 데이터 링크 계층 - 네트워크 계층 까지의 캡슐화와 역캡슐화가 계속 이뤄진다고 이해하면 된다.\n라우터에서 데이터를 받으면 역캡슐화 작업을, 데이터를 보낼 때는 캡슐화 작업을 거친 후 다른 라우터에게 보내진다. 이는 라우터뿐만 아니라 스위치도 마찬가지다.\n스위치도 스위치 끼리 물리 계층 - 데이터 링크 계층 까지 캡슐화와 역캡슐화가 계속 이뤄진다고 이해하면 된다.\n6. Routing Protocols (좀 더 학습 필요) 개요 라우팅 과정에서 사용되는 프로토콜들에 대해 알아보자. 라우팅 프로토콜은 라우팅 정보를 교환하기 위한 프로토콜이다.\n라우팅 방식에는 ‘정적’ 과 ‘동적’ 라우팅으로 나눠진다. 전자는 ‘관리자가 직접 관리’하는 방식으로 수동으로 해야하므로 비효율적이다. 후자는 라우팅 테이블의 정보를 주기적으로 받아 갱신하는 방식이다.\n이번 소단원에서 알아볼 라우팅 프로토콜들은 이 동적 라우팅에 사용되는 프로토콜이다.\n동적 라우팅 프로토콜은 AS(Autonomous System)을 기준으로 어떤 역할을 하느냐에 따라서 내부 라우팅 프로토콜과 외부 라우팅 프로토콜로 분류할 수 있다.\nAS(Autonomous System) 란 하나의 회사나 조직에서 관리하는 라우터들의 집합으로, 이 AS들로 네트워크가 구성되어 체계적으로 네트워크를 관리할 수 있다.\n여러 AS들 간에 라우팅을 수행하는 외부 게이트웨이 라우팅 프로토콜을 ‘EGP(Exterior Gateway routing Protocol)’ 이라고 하며, 하나의 AS 내부에서 라우팅을 수행하는 내부 게이트웨이 라우팅 프로토콜을 ‘IGP(Interior Gateway routing Protocol)’ 라 한다.\nEGP의 종류\nBGP IGP의 종류\nRIP(Routing Information Protocol) OSPF(Open Shortes Path First) 그러면 IGP에 대해 알아보자.\nIGP: RIP(Routing Information Protocol) RIP는 목적지로 도착하기까지 홉 수 정보를 저장하고 인접 라우터와 주기적으로 정보를 공유하는 방법 이다. 여기서 홉 수(Hope Count) 이란? 목적지로 도착하기까지 거쳐야 하는 링크 또는 라우터의 수를 말한다.\n일반적으로 30초 마다 라우팅 테이블을 갱신하며, 120초 동안 정보를 받지 못하면 경로 단절로 판단된다. 단절된 경우 무한 으로 표시하거나, 홉 수 16으로 표시하기도 한다.\n사용 포트로는 UDP 520번 포트를 사용한다.\n그러면 RIP를 사용하는 라우팅 테이블을 아래 그림에서 확인해보자. 아래 그림을 보면 30초마다 갱신되는 정보를 확인할 수 있다. 이렇게 주기적으로 인접 라우터와 정보를 공유하는 방법 이 RIP이다.\nRouter A의 홉 수 계산을 다음 아래와 같이 할 수 있다. 나머지 Router B와 C도 동일한 방식으로 계산된다.\n[Router A]\nRouter A에서 Network 1 또는 2를 가기 위해서는 다른 Router를 거칠 필요가 없으므로 홉 수 0 Router A에서 Network 3을 가기 위해서는 Router B를 거쳐야 하므로 홉 수 1 Router A에서 Network 4를 가기 위해서는 Router B, C를 거쳐야 하므로 홉 수 2 이러한 RIP 방식에는 느린 수렴(Slow Convergence) 문제가 존재한다. 예를 들어서 네트워크와 라우터 간 연결이 끊어졌을 경우, 해당 라우터의 라우팅 테이블에 적힌 홉 수는 무한대로 수정된다. 그러면 주변 라우터들에게도 이 상황 정보가 빠르게 전달되야 하는데, 느리게 전달되어 모든 라우터가 변경 사항을 적용하는데 오랜 시간이 걸린다.\n이 문제점을 해결하기 위해서 3가지 방식 을 사용한다. 첫 번째는 홉 수를 16으로 수정 하여 홉 수가 15를 넘으면 바로 16으로 수정하여 상황 정보를 받지 않아도 바로 수정하는 방식으로 적용 시간을 단축할 수 있다. 두 번째는 Split - Horizon 방식으로 전달하는 정보를 구분하여 전송하는 방식으로 단절 상황에 관한 정보만 전달하고, 다른 라우터에게서 받은 라우팅 정보를 다시 상대방에게 전달하지 않는 방법을 말한다. 세 번째는 Triggered Update 방식이다. 이는 갱신되는 시간 간격 30초와 상관없이 단절되는 상황이 발생하면 바로 전달하는 방식이다.\nIGP: OSPF (Open Shortest Path First) OSPF는 가장 많이 사용하는 IGP(내부 게이트웨이 프로토콜)의 한 종류로, 링크 상태 알고리즘 및 광고 기법으로 사용한다. 가장 짧은 경로 계산은 Dijkstra(다이제스트로) 알고리즘으로 최적의 경로를 계산한다.\n그리고 OSPF는 라우팅을 효과적으로 수행하기 위해서 네트워크를 영역 단위로 나누어 관리하는데, AS 내에 여러 개의 영역으로 나눈 다음 내부의 라우터들끼리 각 영역에서 라우팅 정보를 교환하는 계층적 구조 를 가진다.\nNAT ARP ICMP Reference 나노디그리 러닝스푼즈: Python \u0026 Django backend course 네트워크, 그림으로 이해해자 네트워크 기초(4) - OSI 7계층 - 3계층: 네트워크 계층 ","wordCount":"1624","inLanguage":"en","datePublished":"2023-05-24T15:14:44+09:00","dateModified":"2023-05-24T15:14:44+09:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://jeha00.github.io/post/network/osi_7_layer/3_layer/"},"publisher":{"@type":"Organization","name":"Jeha DevLog","logo":{"@type":"ImageObject","url":"http://jeha00.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://jeha00.github.io/ accesskey=h title="@Jeha00 (Alt + H)">@Jeha00</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://jeha00.github.io/me/ title=About><span>About</span></a></li><li><a href=http://jeha00.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=http://jeha00.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://jeha00.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://jeha00.github.io/>Home</a>&nbsp;»&nbsp;<a href=http://jeha00.github.io/post/>Posts</a></div><h1 class=post-title>[TIL]OSI 7 layer: 3계층 네트워크 계층</h1><div class=post-meta>Network&nbsp;·&nbsp;<span title='2023-05-24 15:14:44 +0900 KST'>May 24, 2023</span></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac-%ed%95%99%ec%8a%b5-%eb%82%b4%ec%9a%a9-%ec%88%9c%ec%84%9c aria-label="네트워크 학습 내용 순서">네트워크 학습 내용 순서</a></li><li><a href=#1-ipinternet-protocol-%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac-%ea%b3%84%ec%b8%b5-%ea%b0%9c%ec%9a%94 aria-label="1. IP(Internet Protocol) 네트워크 계층 개요">1. IP(Internet Protocol) 네트워크 계층 개요</a><ul><ul><li><a href=#%eb%b9%84%ec%8b%a0%eb%a2%b0%ec%84%b1 aria-label=비신뢰성>비신뢰성</a></li><li><a href=#%eb%b9%84%ec%97%b0%ea%b2%b0%ed%98%95 aria-label=비연결형>비연결형</a></li><li><a href=#%ec%a3%bc%ec%86%8c-%ec%a7%80%ec%a0%95 aria-label="주소 지정">주소 지정</a></li><li><a href=#%ea%b2%bd%eb%a1%9c-%ea%b2%b0%ec%a0%95 aria-label="경로 결정">경로 결정</a></li></ul></ul></li><li><a href=#2-ip-%ec%a3%bc%ec%86%8c aria-label="2. IP 주소">2. IP 주소</a><ul><ul><li><a href=#ip-%ec%a3%bc%ec%86%8c%eb%9e%80-%ea%b7%b8%eb%a6%ac%ea%b3%a0-ip-%ec%a3%bc%ec%86%8c%ec%9d%98-%ec%82%ac%ec%9a%a9-%eb%aa%a9%ec%a0%81 aria-label="IP 주소란? 그리고 IP 주소의 사용 목적">IP 주소란? 그리고 IP 주소의 사용 목적</a></li><li><a href=#ipv6-%eb%b2%84%ec%a0%84%ec%9d%80-ipv4%eb%a5%bc-%eb%8c%80%ec%b2%b4%ed%95%98%ea%b8%b0-%ec%9c%84%ed%95%b4-%eb%93%b1%ec%9e%a5 aria-label="IPv6 버전은 IPv4를 대체하기 위해 등장">IPv6 버전은 IPv4를 대체하기 위해 등장</a></li><li><a href=#network-id%ec%99%80-host-id aria-label="Network ID와 Host ID">Network ID와 Host ID</a></li><li><a href=#ip-%ec%a3%bc%ec%86%8c-%ed%81%b4%eb%9e%98%ec%8a%a4-ipv4-%ea%b8%b0%ec%a4%80 aria-label="IP 주소 클래스 (IPv4 기준)">IP 주소 클래스 (IPv4 기준)</a></li><li><a href=#mac-%ec%a3%bc%ec%86%8c%ec%99%80-%eb%b9%84%ea%b5%90 aria-label="MAC 주소와 비교">MAC 주소와 비교</a></li><li><a href=#a-b-class%ec%9d%98-%eb%ac%b8%ec%a0%9c%ec%a0%90%ea%b3%bc-%ed%95%b4%ea%b2%b0%ec%b1%85 aria-label="A, B class의 문제점과 해결책">A, B class의 문제점과 해결책</a></li></ul></ul></li><li><a href=#3-subnetting%ec%84%9c%eb%b8%8c%eb%84%b7%ed%8c%85 aria-label="3. Subnetting(서브넷팅)">3. Subnetting(서브넷팅)</a><ul><ul><li><a href=#subnetting-subnet%ec%84%9c%eb%b8%8c%eb%84%b7-subnet-mask%ec%84%9c%eb%b8%8c%eb%84%b7-%eb%a7%88%ec%8a%a4%ed%81%ac-%eb%9e%80 aria-label="Subnetting, Subnet(서브넷), Subnet mask(서브넷 마스크) 란?">Subnetting, Subnet(서브넷), Subnet mask(서브넷 마스크) 란?</a></li><li><a href=#%ed%81%b4%eb%9e%98%ec%8a%a4%eb%b3%84-%ec%84%9c%eb%b8%8c%eb%84%b7-%eb%a7%88%ec%8a%a4%ed%81%ac aria-label="클래스별 서브넷 마스크">클래스별 서브넷 마스크</a></li></ul></ul></li><li><a href=#4-ip-packet-%ea%b3%bc-header aria-label="4. IP packet 과 header">4. IP packet 과 header</a><ul><ul><li><a href=#%ec%97%ad%ec%ba%a1%ec%8a%90%ed%99%94%ec%9d%98-%ea%b4%80%ec%a0%90%ec%97%90%ec%84%9c-packet%ec%9d%b4%eb%9e%80 aria-label="역캡슐화의 관점에서 packet이란?">역캡슐화의 관점에서 packet이란?</a></li><li><a href=#%ec%ba%a1%ec%8a%90%ed%99%94%ec%9d%98-%ea%b4%80%ec%a0%90%ec%97%90%ec%84%9c-packet%ec%9d%b4%eb%9e%80 aria-label="캡슐화의 관점에서 packet이란?">캡슐화의 관점에서 packet이란?</a></li><li><a href=#ip-packet-header%ec%97%90%eb%8a%94-%ec%96%b4%eb%96%a4-%ec%a0%95%eb%b3%b4%ea%b0%80-%eb%8b%b4%ea%b2%a8%ec%a0%b8-%ec%9e%88%eb%8a%94%ea%b0%80-ipv4-%ea%b8%b0%ec%a4%80 aria-label="IP packet header에는 어떤 정보가 담겨져 있는가? (IPv4 기준)">IP packet header에는 어떤 정보가 담겨져 있는가? (IPv4 기준)</a></li></ul></ul></li><li><a href=#5-router aria-label="5. Router">5. Router</a><ul><ul><li><a href=#router%ec%9d%98-%ec%97%ad%ed%95%a0 aria-label="Router의 역할">Router의 역할</a></li><li><a href=#routing-%ea%b3%bc-routing-table aria-label="Routing 과 Routing table">Routing 과 Routing table</a></li><li><a href=#%eb%9d%bc%ec%9a%b0%ed%84%b0%ec%97%90%ec%84%9c-mac-%ec%a3%bc%ec%86%8c%ec%99%80-ip-%ec%a3%bc%ec%86%8c aria-label="라우터에서 MAC 주소와 IP 주소">라우터에서 MAC 주소와 IP 주소</a></li><li><a href=#%eb%9d%bc%ec%9a%b0%ed%84%b0-%ea%b0%84%ec%9d%98-%ed%86%b5%ec%8b%a0- aria-label="라우터 간의 통신 🔆">라우터 간의 통신 🔆</a></li></ul></ul></li><li><a href=#6-routing-protocols-%ec%a2%80-%eb%8d%94-%ed%95%99%ec%8a%b5-%ed%95%84%ec%9a%94 aria-label="6. Routing Protocols (좀 더 학습 필요)">6. Routing Protocols (좀 더 학습 필요)</a><ul><ul><li><a href=#%ea%b0%9c%ec%9a%94 aria-label=개요>개요</a></li><li><a href=#igp-riprouting-information-protocol aria-label="IGP: RIP(Routing Information Protocol)">IGP: RIP(Routing Information Protocol)</a></li><li><a href=#igp-ospf-open-shortest-path-first aria-label="IGP: OSPF (Open Shortest Path First)">IGP: OSPF (Open Shortest Path First)</a></li><li><a href=#nat aria-label=NAT>NAT</a></li><li><a href=#arp aria-label=ARP>ARP</a></li><li><a href=#icmp aria-label=ICMP>ICMP</a></li></ul></ul></li><li><a href=#reference aria-label=Reference>Reference</a></li></ul></div></details></div><div class=post-content><h1 id=네트워크-학습-내용-순서>네트워크 학습 내용 순서<a hidden class=anchor aria-hidden=true href=#네트워크-학습-내용-순서>#</a></h1><ol><li><a href=https://jeha00.github.io/post/network/osi_7_layer/0_outline/>[TIL]Web Application Basic study: OSI 7 layer outline</a></li><li><a href=https://jeha00.github.io/post/network/osi_7_layer/1_layer/>[TIL] Network OSI 7 layer: 1계층</a></li><li><a href=https://jeha00.github.io/post/network/osi_7_layer/2_layer/>[TIL] Network OSI 7 layer: 2계층</a></li></ol><p>이번 장에서는 네트워크(Network) 계층인 3계층에 대해 알아보자.</p><p> </p><h1 id=1-ipinternet-protocol-네트워크-계층-개요>1. IP(Internet Protocol) 네트워크 계층 개요<a hidden class=anchor aria-hidden=true href=#1-ipinternet-protocol-네트워크-계층-개요>#</a></h1><hr><p>네트워크 계층은 <strong><em>한 네트워크와 다른 네트워크 간 통신하기 위해 IP를 결정하는 계층</em></strong> 으로, 사용하는 &lsquo;주요 프로토콜&rsquo;은 <strong><em>IP(Internet Protocol)</em></strong> 를 사용한다. &lsquo;주요 네트워크 기기&rsquo;는 <strong><em>라우터</em></strong> 이며, &lsquo;주요 데이터 단위&rsquo; 는 <strong><em>packet</em></strong> 이다.</p><p>네트워크 계층의 특징은 아래 4가지로 요약할 수 있다.</p><h3 id=비신뢰성>비신뢰성<a hidden class=anchor aria-hidden=true href=#비신뢰성>#</a></h3><p>데이터가 송신지까지 도달하는 걸 보장하지 않는다. 그래서 인터넷 계층의 윗 계층인 4계층 전송 계층에서 이를 갖춘다. 그래서 데이터 순서가 바뀔 수도 있고, 서로 다른 경로를 통해 전송될 수 있다.</p><h3 id=비연결형>비연결형<a hidden class=anchor aria-hidden=true href=#비연결형>#</a></h3><p>4계층 전송 계층과는 달리 연결설정 과정 없이 데이터를 전송한다.</p><h3 id=주소-지정>주소 지정<a hidden class=anchor aria-hidden=true href=#주소-지정>#</a></h3><p>IP 주소를 제공하여 각 기기 장치가 식별될 수 있도록 하는 역할을 한다. MAC 주소는 컴퓨터의 물리적인 식별자라면 IP 주소는 인터넷 연결 간 논리적인 식별을 하는데 사용된다.</p><h3 id=경로-결정>경로 결정<a hidden class=anchor aria-hidden=true href=#경로-결정>#</a></h3><p>이 IP 주소를 통해 라우팅의 경로 설정도 가능하다.</p><p> </p><h1 id=2-ip-주소>2. IP 주소<a hidden class=anchor aria-hidden=true href=#2-ip-주소>#</a></h1><hr><h3 id=ip-주소란-그리고-ip-주소의-사용-목적>IP 주소란? 그리고 IP 주소의 사용 목적<a hidden class=anchor aria-hidden=true href=#ip-주소란-그리고-ip-주소의-사용-목적>#</a></h3><p>각 기기들을 식별하기 위한 논리적인 주소를 말한다. 네트워크에 연결되어 있는 기기(호스트나 라우터)들은 자신의 고유한 주소를 갖고 있어야 데이터를 주고 받을 수 있다. 이를 위해서 인터넷 프로토콜은 논리적인 주소인 IP 주소를 제공하여 데이터를 서로 송수신할 수 있게 한다.</p><h1 id=heading><a hidden class=anchor aria-hidden=true href=#heading>#</a></h1><h3 id=ipv6-버전은-ipv4를-대체하기-위해-등장>IPv6 버전은 IPv4를 대체하기 위해 등장<a hidden class=anchor aria-hidden=true href=#ipv6-버전은-ipv4를-대체하기-위해-등장>#</a></h3><p>IPv4 에서 4는 . 으로 나눠진 부분이 4군데여서 그렇다는 게 아닌 IP 를 표시하는 게 4세대 버전이라는 의미다. IPv6는 6세대 버전이라는 의미.</p><ul><li>IPv4: Internet Protocol version 4</li><li>IPv6: Internet Protocol version 6</li></ul><table><thead><tr><th></th><th>IPv4</th><th>IPv6</th></tr></thead><tbody><tr><td>주소 형식</td><td>192.168.10.1</td><td>FE80:CD00:0000:0CDE:1257:0000:211E:729C</td></tr><tr><td>주소 표현</td><td>10진수</td><td>16진수</td></tr><tr><td>크기</td><td>32bit(4 bytes)</td><td>128bit(16 bytes)</td></tr><tr><td>최대 표현 개수</td><td>약 43억개 범위: 0.0.0.0 ~ 255.255.255.255</td><td>무한대에 가깝다.</td></tr><tr><td>서비스 품질</td><td>제한적 품질</td><td>확장된 품질</td></tr><tr><td>보안 기능</td><td>IPSec 별도 설치</td><td>기본 제공</td></tr></tbody></table><ul><li><p>크기</p><ul><li>IPv4 기준으로 각각 8bit씩 총 4 부분 * 8bit = 32bit를 이룬다.</li><li>IPv6 기준으로 각각 8bit씩 총 8 부분 * 16bit = 128bit를 이룬다.</li></ul></li><li><p>8bit를 1 옥텟(octet)이라 부른다.</p></li></ul><h1 id=heading-1><a hidden class=anchor aria-hidden=true href=#heading-1>#</a></h1><h3 id=network-id와-host-id>Network ID와 Host ID<a hidden class=anchor aria-hidden=true href=#network-id와-host-id>#</a></h3><p>범위에 따라 Network ID와 Host ID로 구분할 수 있다.</p><ul><li><p>네트워크 ID: 전체 중 작은 네트워크를 식별하는 ID이자 호스트의 집합 대표 주소</p></li><li><p>호스트 ID: 호스트를 식별</p></li></ul><figure><img loading=lazy src=https://user-images.githubusercontent.com/78094972/241970333-5b71f22d-e266-49b0-a189-a8d5c90c2f34.png width=60%></figure><h1 id=heading-2><a hidden class=anchor aria-hidden=true href=#heading-2>#</a></h1><h3 id=ip-주소-클래스-ipv4-기준>IP 주소 클래스 (IPv4 기준)<a hidden class=anchor aria-hidden=true href=#ip-주소-클래스-ipv4-기준>#</a></h3><table><thead><tr><th>클래스</th><th>IPv4 (2진수)</th><th>IPv4 (10진수)</th><th>네트워크 ID</th><th>호스트 ID</th><th>비고</th></tr></thead><tbody><tr><td>A</td><td>00000001. 00000000. 00000000. 00000000</td><td>0.0.0.0 ~ 127.255.255.255</td><td>8 bit</td><td>24 bit</td><td></td></tr><tr><td>B</td><td>10000000. 00000000. 00000000. 00000000</td><td><strong>128</strong> .0.0.0 ~ 191.255.255.255</td><td>16 bit</td><td>16 bit</td><td></td></tr><tr><td>C</td><td>11000000. 00000000. 00000000. 00000000</td><td><strong>192</strong> .0.0.0 ~ 223.255.255.255</td><td>24bit</td><td>8 bit</td><td></td></tr><tr><td>D</td><td>11100000. 00000000. 00000000. 00000000</td><td><strong>224</strong>.0.0.0 ~ 239.255.255.255</td><td></td><td></td><td>멀티캐스트용</td></tr><tr><td>E</td><td>11110000. 00000000. 00000000. 00000000</td><td><strong>240</strong>.0.0.0 ~ 239.255.255.255</td><td></td><td></td><td>특수용도 예약주소</td></tr></tbody></table><ul><li>docker IP는 B 클래스에 해당된다.</li></ul><h3 id=mac-주소와-비교>MAC 주소와 비교<a hidden class=anchor aria-hidden=true href=#mac-주소와-비교>#</a></h3><ul><li>MAC 주소: 48 bit, 16진수</li><li>IP 주소 (IPv4): 32 bit, 2진수<ul><li>실제로는 2진수로 되어 있고, 사람이 보기 편하게 10진수로 되어 있다.</li></ul></li></ul><h3 id=a-b-class의-문제점과-해결책>A, B class의 문제점과 해결책<a hidden class=anchor aria-hidden=true href=#a-b-class의-문제점과-해결책>#</a></h3><p>A 클래스와 B 클래스는 하나의 IP 주소로 많은 호스트를 가질 수 있다. 그런데 한 기관에서 이렇게 많은 호스트를 가지게 되는 경우는 없기 때문에, IP 주소가 낭비되는 문제가 발생된다. 또한, 이렇게 많은 컴퓨터가 패킷을 보내면 네트워크가 혼잡해진다. 이러한 문제점을 해결하는 방법이 이어서 학습할 내용인 <strong>&ldquo;서브넷팅&rdquo;</strong> 이다.</p><p> </p><h1 id=3-subnetting서브넷팅>3. Subnetting(서브넷팅)<a hidden class=anchor aria-hidden=true href=#3-subnetting서브넷팅>#</a></h1><hr><h3 id=subnetting-subnet서브넷-subnet-mask서브넷-마스크-란>Subnetting, Subnet(서브넷), Subnet mask(서브넷 마스크) 란?<a hidden class=anchor aria-hidden=true href=#subnetting-subnet서브넷-subnet-mask서브넷-마스크-란>#</a></h3><p><strong><em>서브넷팅(subnetting)</em></strong> 이란 IP 주소를 클래스로 구분하는 방법으로, 네트워크를 작은 네트워크로 분할하여 너무 많은 IP 주소들이 낭비되는 문제를 해결하기 위한 기술이다. 이 분할된 네트워크를 <strong><em>Subnet(서브넷)</em></strong> 이라고 부른다. 서브넷들의 IP에서 어디까지가 네트워크 ID이고 호스트 ID인지 식별하기가 어려운데, 이를 돕는 게 바로 <strong><em>Subnet mask(서브넷 마스크)</em></strong> 이다. 네트워크 ID와 호스트 ID를 식별하기 위해서, 네트워크 ID에 해당되는 부분을 모두 1로, 호스트 ID에 해당하는 부분을 모두 0으로 표기하는 형식을 말한다.</p><h3 id=클래스별-서브넷-마스크>클래스별 서브넷 마스크<a hidden class=anchor aria-hidden=true href=#클래스별-서브넷-마스크>#</a></h3><p>그래서 서브넷 마스크를 클래스 별로 표시하자면 다음과 같다.</p><table><thead><tr><th>클래스</th><th>IPv4 (2진수)</th><th>IPv4 (10진수)</th><th>프리픽스 표기법</th></tr></thead><tbody><tr><td>A</td><td>255.0.0.0</td><td>11111111 00000000 00000000 00000000</td><td>/8</td></tr><tr><td>B</td><td>255.255.0.0</td><td>11111111 11111111 00000000 00000000</td><td>/16</td></tr><tr><td>c</td><td>255.255.255.0</td><td>11111111 11111111 11111111 00000000</td><td>/24</td></tr></tbody></table><p>🔆 프리픽스 표기법: 서브넷 마스크를 슬래시 비트 수로 나타낸 것으로, 네트워크 ID 부분을 나타낸다.</p><p>그래서 255.255.255.240인 경우, 8bit 3개에 4bit를 더해서 /28 로 표기한다.</p><p> </p><h1 id=4-ip-packet-과-header>4. IP packet 과 header<a hidden class=anchor aria-hidden=true href=#4-ip-packet-과-header>#</a></h1><hr><h3 id=역캡슐화의-관점에서-packet이란>역캡슐화의 관점에서 packet이란?<a hidden class=anchor aria-hidden=true href=#역캡슐화의-관점에서-packet이란>#</a></h3><p>네트워크 계층보다 더 아래에 있는 데이터 링크 계층에서는 데이터 단위를 &lsquo;프레임(frame)&lsquo;을 사용한다. 이 프레임에서 역캡슐화를 통해 이더넷 헤더와 트레일러를 제거한 것이 네트워크 계층에서의 프로토콜 데이터 단위인 &lsquo;패킷(packet)&lsquo;이 된다.</p><h3 id=캡슐화의-관점에서-packet이란>캡슐화의 관점에서 packet이란?<a hidden class=anchor aria-hidden=true href=#캡슐화의-관점에서-packet이란>#</a></h3><p>또 네트워크 계층보다 위 계층의 데이터 단위인 TCP 세그먼트에서 캡슐화해서 IP 헤더를 붙인 것도 &lsquo;패킷(packet)&lsquo;이다.</p><p><img loading=lazy src=https://user-images.githubusercontent.com/78094972/236663376-e5648e74-186b-4fbe-b305-3ae6c6d0a48f.png alt=image></p><h3 id=ip-packet-header에는-어떤-정보가-담겨져-있는가-ipv4-기준>IP packet header에는 어떤 정보가 담겨져 있는가? (IPv4 기준)<a hidden class=anchor aria-hidden=true href=#ip-packet-header에는-어떤-정보가-담겨져-있는가-ipv4-기준>#</a></h3><p>데이터를 전달하기 위한 정보들이 포함되어 있다. 이 정보들을 사용하여 네트워크 계층의 장비인 라우터가 라우팅 동작을 하는데 핵심적인 역할을 수행한다.</p><p><img loading=lazy src=https://github.com/JeHa00/image/assets/78094972/2746a673-91f6-4f0a-980c-237a91b5e14b alt=image></p><p> </p><h1 id=5-router>5. Router<a hidden class=anchor aria-hidden=true href=#5-router>#</a></h1><hr><p>가정 내에의 네트워크(LAN)에서 인터넷 네트워크(WAN)로 접속하기 위해서는 라우터가 필요하다. 그 이유는 이 라우터에는 ISP(ex: KT, SK telecom, LG U+)를 통해서 공인 IP를 부여받은 라우터를 거쳐야하기 때문이다.</p><h3 id=router의-역할>Router의 역할<a hidden class=anchor aria-hidden=true href=#router의-역할>#</a></h3><p>라우터는 위 내용을 보다 일반화해서 표현하자면 <strong><em>&lsquo;한&rsquo; 네트워크에서 &lsquo;다른&rsquo; 네트워크로 데이터를 보내는 역할</em></strong> 을 한다.</p><p>그러면 네트워크 계층보다 하위 계층인 데이터 링크 계층의 장비인 스위치부터 다시 생각해보자.</p><p>스위치에 연결된 장비들은 같은 네트워크 범위에 있다. 그런데 네트워크를 통해 데이터를 보낼 때 반드시 동일한 네트워크 범위 내로만 보내는 게 아니다. 다른 네트워크에 있는 곳으로도 데이터를 보내야 한다. 이 때 이 네트워크 계층을 지나야하고, 이 계층에서의 장비가 &lsquo;라우터&rsquo;다. 이 라우터를 지나면 <strong>바로 다른 네트워크</strong> 로 갈 수 있지만, 때로는 목적지 네트워크에 도달하기 위해 해당 네트워크와 보다 가까운 <strong>&lsquo;다른 라우터&rsquo;를 판단</strong> 하기도 한다.</p><p>아래 이미지를 통해 보다 자세히 알아보자.</p><p><img loading=lazy src=https://github.com/JeHa00/image/assets/78094972/dc1daec8-f671-4173-8eda-9e9f997d269f alt=image></p><p>Network 1과 Network 3 사이에는 Network 2가 존재한다. Router 1은 network 1 뿐만 아니라 network 2에도 연결이 되어 있다. 복수의 인터페이스를 제공하며 이에 맞는 물리적 배선과 IP 주소가 설정되어 있다. 그래서 라우터에는 각 네트워크마다 연결되어 있어서 여러 IP 주소를 가진다.</p><h3 id=routing-과-routing-table>Routing 과 Routing table<a hidden class=anchor aria-hidden=true href=#routing-과-routing-table>#</a></h3><p>그렇다면 라우터는 다른 네트워크로 가는 경로를 어떻게 아는 것일까? 이에 대한 답은 바로 &lsquo;라우팅 테이블&rsquo; 에 있다. 위 이미지 양 끝단에 Router 1과 Router 2에 대한 라우팅 테이블이 존재한다.</p><p>라우팅 테이블에 대해 간략히 설명하기에 앞서 &lsquo;라우팅&rsquo; 이란 단어에 대해 알아보자.</p><p><strong><em>라우팅</em></strong> 이란 패킷을 목적지 IP까지 최적의 경로로 전송할 수 있도록 이 경로를 찾는 동작을 말한다. 이 라우팅을 하기 위해서는 경로에 대한 정보를 라우터가 가지고 있어야 가능하다. 그 정보가 등록되고 관리되는 테이블이 <strong><em>라우팅 테이블</em></strong> 이다. 라우팅 하기 위해 라우팅 테이블을 이용한다.</p><h3 id=라우터에서-mac-주소와-ip-주소>라우터에서 MAC 주소와 IP 주소<a hidden class=anchor aria-hidden=true href=#라우터에서-mac-주소와-ip-주소>#</a></h3><p><strong><em>MAC 주소는 우리가 사용하는 desktop, labtop 뿐만 아니라 스위치와 라우터도 포함하여 각 장치마다 부여된 고유의 물리적인 주소다.</em></strong> MAC 주소는 랜카드에 탑재되어 있고, 랜카드(LAN card 또는 Network Interface Card, NIC)는 각 기기마다 존재하기 때문이다.</p><p>다른 네트워크에 전달하기 위해서는 여러 기기들을 전송 도중에 거쳐야하기 때문에 <strong><em>라우터를 거치면 도착지 MAC 주소와 출발지 MAC 주소를 바꿔가며 전송하게 된다. 즉 프레임 데이터의 관점에서 보자면 이더넷헤더와 FCS(트레일러)가 교체된다는 의미다.</em></strong> 다음으로 전송해야할 MAC 주소를 알아내기 위해서 &lsquo;ARP&rsquo; 라는 다른 프로토콜을 사용한다.</p><p>하지만, IP 헤더의 경우 NAT 주소 변환 시를 제외하고는 <strong><em>도착지 IP와 출발지 IP 주소는 변하지 않고, TTL과 헤더 체크섬이 변경된다.</em></strong></p><h3 id=라우터-간의-통신->라우터 간의 통신 🔆<a hidden class=anchor aria-hidden=true href=#라우터-간의-통신->#</a></h3><p>그렇다면 라우터 간 통신은 어떻게 하는 걸까?</p><p><img loading=lazy src=https://cdn.inflearn.com/public/comments/a57361ca-c24a-4744-b91e-f11b6b8cd194/%EC%84%A4%EB%AA%85.jpg alt=image></p><ul><li>출처: <a href=https://www.inflearn.com/questions/661260/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%A0%84%EB%B0%98%EC%A0%81%EC%9D%B8-%EA%B3%BC%EC%A0%95%EC%97%90-%EB%8C%80%ED%95%B4-%EB%AC%B8%EC%9D%98%EB%93%9C%EB%A6%BD%EB%8B%88%EB%8B%A4>네트워크 전반적인 과정에 대해 문의드립니다.</a></li></ul><p>위 출처에 따르자면 한 라우터에 다른 라우터로 이동할 때 라우터마다 내부적으로 <strong><em>물리 계층 - 데이터 링크 계층 - 네트워크 계층</em></strong> 까지의 캡슐화와 역캡슐화가 계속 이뤄진다고 이해하면 된다.</p><p>라우터에서 데이터를 받으면 역캡슐화 작업을, 데이터를 보낼 때는 캡슐화 작업을 거친 후 다른 라우터에게 보내진다. 이는 라우터뿐만 아니라 스위치도 마찬가지다.</p><p>스위치도 스위치 끼리 <strong><em>물리 계층 - 데이터 링크 계층</em></strong> 까지 캡슐화와 역캡슐화가 계속 이뤄진다고 이해하면 된다.</p><p> </p><h1 id=6-routing-protocols-좀-더-학습-필요>6. Routing Protocols (좀 더 학습 필요)<a hidden class=anchor aria-hidden=true href=#6-routing-protocols-좀-더-학습-필요>#</a></h1><hr><h3 id=개요>개요<a hidden class=anchor aria-hidden=true href=#개요>#</a></h3><p>라우팅 과정에서 사용되는 프로토콜들에 대해 알아보자. 라우팅 프로토콜은 라우팅 정보를 교환하기 위한 프로토콜이다.</p><p>라우팅 방식에는 <strong>&lsquo;정적&rsquo;</strong> 과 <strong>&lsquo;동적&rsquo;</strong> 라우팅으로 나눠진다. 전자는 &lsquo;관리자가 직접 관리&rsquo;하는 방식으로 수동으로 해야하므로 비효율적이다. 후자는 라우팅 테이블의 정보를 주기적으로 받아 갱신하는 방식이다.</p><p>이번 소단원에서 알아볼 라우팅 프로토콜들은 이 동적 라우팅에 사용되는 프로토콜이다.</p><p>동적 라우팅 프로토콜은 AS(Autonomous System)을 기준으로 어떤 역할을 하느냐에 따라서 내부 라우팅 프로토콜과 외부 라우팅 프로토콜로 분류할 수 있다.</p><p><strong>AS(Autonomous System)</strong> 란 하나의 회사나 조직에서 관리하는 라우터들의 집합으로, 이 AS들로 네트워크가 구성되어 체계적으로 네트워크를 관리할 수 있다.</p><p><img loading=lazy src=https://github.com/JeHa00/image/assets/78094972/67b227fb-17d1-4d44-89ff-1886de772c32 alt=image></p><p>여러 AS들 간에 라우팅을 수행하는 외부 게이트웨이 라우팅 프로토콜을 <strong>&lsquo;EGP(Exterior Gateway routing Protocol)&rsquo;</strong> 이라고 하며, 하나의 AS 내부에서 라우팅을 수행하는 내부 게이트웨이 라우팅 프로토콜을 <strong>&lsquo;IGP(Interior Gateway routing Protocol)&rsquo;</strong> 라 한다.</p><ul><li><p>EGP의 종류</p><ul><li>BGP</li></ul></li><li><p>IGP의 종류</p><ul><li>RIP(Routing Information Protocol)</li><li>OSPF(Open Shortes Path First)</li></ul></li></ul><p>그러면 IGP에 대해 알아보자.</p><h1 id=heading-3><a hidden class=anchor aria-hidden=true href=#heading-3>#</a></h1><h3 id=igp-riprouting-information-protocol>IGP: RIP(Routing Information Protocol)<a hidden class=anchor aria-hidden=true href=#igp-riprouting-information-protocol>#</a></h3><p>RIP는 <strong><em>목적지로 도착하기까지 홉 수 정보를 저장하고 인접 라우터와 주기적으로 정보를 공유하는 방법</em></strong> 이다. 여기서 <strong>홉 수(Hope Count)</strong> 이란? 목적지로 도착하기까지 거쳐야 하는 링크 또는 라우터의 수를 말한다.</p><p>일반적으로 <strong>30초</strong> 마다 라우팅 테이블을 갱신하며, <strong>120초</strong> 동안 정보를 받지 못하면 경로 단절로 판단된다. 단절된 경우 <strong>무한</strong> 으로 표시하거나, 홉 수 16으로 표시하기도 한다.</p><p>사용 포트로는 UDP 520번 포트를 사용한다.</p><p>그러면 RIP를 사용하는 라우팅 테이블을 아래 그림에서 확인해보자. 아래 그림을 보면 30초마다 갱신되는 정보를 확인할 수 있다. 이렇게 <em>주기적으로 인접 라우터와 정보를 공유하는 방법</em> 이 RIP이다.</p><p><img loading=lazy src=https://github.com/JeHa00/image/assets/78094972/1d16cc07-8219-4818-b87c-014248cf2e6f alt=image></p><p>Router A의 홉 수 계산을 다음 아래와 같이 할 수 있다. 나머지 Router B와 C도 동일한 방식으로 계산된다.</p><p>[Router A]</p><ul><li>Router A에서 Network 1 또는 2를 가기 위해서는 다른 Router를 거칠 필요가 없으므로 홉 수 0</li><li>Router A에서 Network 3을 가기 위해서는 Router B를 거쳐야 하므로 홉 수 1</li><li>Router A에서 Network 4를 가기 위해서는 Router B, C를 거쳐야 하므로 홉 수 2</li></ul><p>이러한 RIP 방식에는 <em>느린 수렴(Slow Convergence)</em> 문제가 존재한다. 예를 들어서 네트워크와 라우터 간 연결이 끊어졌을 경우, 해당 라우터의 라우팅 테이블에 적힌 홉 수는 무한대로 수정된다. 그러면 주변 라우터들에게도 이 상황 정보가 빠르게 전달되야 하는데, 느리게 전달되어 모든 라우터가 변경 사항을 적용하는데 오랜 시간이 걸린다.</p><p>이 문제점을 해결하기 위해서 <strong><em>3가지 방식</em></strong> 을 사용한다. 첫 번째는 <strong>홉 수를 16으로 수정</strong> 하여 홉 수가 15를 넘으면 바로 16으로 수정하여 상황 정보를 받지 않아도 바로 수정하는 방식으로 적용 시간을 단축할 수 있다. 두 번째는 <strong>Split - Horizon</strong> 방식으로 전달하는 정보를 구분하여 전송하는 방식으로 단절 상황에 관한 정보만 전달하고, 다른 라우터에게서 받은 라우팅 정보를 다시 상대방에게 전달하지 않는 방법을 말한다. 세 번째는 <strong>Triggered Update</strong> 방식이다. 이는 갱신되는 시간 간격 30초와 상관없이 단절되는 상황이 발생하면 바로 전달하는 방식이다.</p><h1 id=heading-4><a hidden class=anchor aria-hidden=true href=#heading-4>#</a></h1><h3 id=igp-ospf-open-shortest-path-first>IGP: OSPF (Open Shortest Path First)<a hidden class=anchor aria-hidden=true href=#igp-ospf-open-shortest-path-first>#</a></h3><p>OSPF는 가장 많이 사용하는 IGP(내부 게이트웨이 프로토콜)의 한 종류로, 링크 상태 알고리즘 및 광고 기법으로 사용한다. 가장 짧은 경로 계산은 Dijkstra(다이제스트로) 알고리즘으로 최적의 경로를 계산한다.</p><p>그리고 OSPF는 라우팅을 효과적으로 수행하기 위해서 네트워크를 영역 단위로 나누어 관리하는데, AS 내에 <strong>여러 개의 영역으로 나눈 다음</strong> 내부의 라우터들끼리 각 영역에서 라우팅 정보를 교환하는 <strong>계층적 구조</strong> 를 가진다.</p><h3 id=nat>NAT<a hidden class=anchor aria-hidden=true href=#nat>#</a></h3><h1 id=heading-5><a hidden class=anchor aria-hidden=true href=#heading-5>#</a></h1><h3 id=arp>ARP<a hidden class=anchor aria-hidden=true href=#arp>#</a></h3><h1 id=heading-6><a hidden class=anchor aria-hidden=true href=#heading-6>#</a></h1><h3 id=icmp>ICMP<a hidden class=anchor aria-hidden=true href=#icmp>#</a></h3><p> </p><hr><h1 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h1><ul><li><a href=https://learningspoons.com/course/detail/django-backend/>나노디그리 러닝스푼즈: Python & Django backend course</a></li><li><a href=https://www.inflearn.com/course/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EA%B7%B8%EB%A6%BC-%EC%9D%B4%ED%95%B4/dashboard>네트워크, 그림으로 이해해자</a></li><li><a href=https://losskatsu.github.io/os-kernel/network-basic04/#2-%EB%9D%BC%EC%9A%B0%ED%84%B0>네트워크 기초(4) - OSI 7계층 - 3계층: 네트워크 계층</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://jeha00.github.io/tags/til/>TIL</a></li><li><a href=http://jeha00.github.io/tags/network/>Network</a></li></ul><nav class=paginav><a class=prev href=http://jeha00.github.io/post/ci_cd/github_action/lecture_01/><span class=title>« Prev Page</span><br><span>CI/CD를 위한 github action study basic</span></a>
<a class=next href=http://jeha00.github.io/post/network/osi_7_layer/2_layer/><span class=title>Next Page »</span><br><span>[TIL]OSI 7 layer: 2계층 데이터 링크 계층</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share [TIL]OSI 7 layer: 3계층 네트워크 계층 on twitter" href="https://twitter.com/intent/tweet/?text=%5bTIL%5dOSI%207%20layer%3a%203%ea%b3%84%ec%b8%b5%20%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac%20%ea%b3%84%ec%b8%b5&url=http%3a%2f%2fjeha00.github.io%2fpost%2fnetwork%2fosi_7_layer%2f3_layer%2f&hashtags=TIL%2cNetwork"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [TIL]OSI 7 layer: 3계층 네트워크 계층 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fjeha00.github.io%2fpost%2fnetwork%2fosi_7_layer%2f3_layer%2f&title=%5bTIL%5dOSI%207%20layer%3a%203%ea%b3%84%ec%b8%b5%20%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac%20%ea%b3%84%ec%b8%b5&summary=%5bTIL%5dOSI%207%20layer%3a%203%ea%b3%84%ec%b8%b5%20%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac%20%ea%b3%84%ec%b8%b5&source=http%3a%2f%2fjeha00.github.io%2fpost%2fnetwork%2fosi_7_layer%2f3_layer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [TIL]OSI 7 layer: 3계층 네트워크 계층 on reddit" href="https://reddit.com/submit?url=http%3a%2f%2fjeha00.github.io%2fpost%2fnetwork%2fosi_7_layer%2f3_layer%2f&title=%5bTIL%5dOSI%207%20layer%3a%203%ea%b3%84%ec%b8%b5%20%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac%20%ea%b3%84%ec%b8%b5"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [TIL]OSI 7 layer: 3계층 네트워크 계층 on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2fjeha00.github.io%2fpost%2fnetwork%2fosi_7_layer%2f3_layer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [TIL]OSI 7 layer: 3계층 네트워크 계층 on whatsapp" href="https://api.whatsapp.com/send?text=%5bTIL%5dOSI%207%20layer%3a%203%ea%b3%84%ec%b8%b5%20%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac%20%ea%b3%84%ec%b8%b5%20-%20http%3a%2f%2fjeha00.github.io%2fpost%2fnetwork%2fosi_7_layer%2f3_layer%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share [TIL]OSI 7 layer: 3계층 네트워크 계층 on telegram" href="https://telegram.me/share/url?text=%5bTIL%5dOSI%207%20layer%3a%203%ea%b3%84%ec%b8%b5%20%eb%84%a4%ed%8a%b8%ec%9b%8c%ed%81%ac%20%ea%b3%84%ec%b8%b5&url=http%3a%2f%2fjeha00.github.io%2fpost%2fnetwork%2fosi_7_layer%2f3_layer%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://jeha00.github.io/>Jeha DevLog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>