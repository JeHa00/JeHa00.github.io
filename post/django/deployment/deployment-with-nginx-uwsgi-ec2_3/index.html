<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기 | Jeha DevLog</title><meta name=keywords content="Django"><meta name=description content="uwsgi, nginx 를 연결했으니, R3에 연결하여 static file을 적용해본다."><meta name=author content="Me"><link rel=canonical href=http://jeha00.github.io/post/django/deployment/deployment-with-nginx-uwsgi-ec2_3/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.min.8330bf30523628d00ababead16d63a7b5cd7570bd4901cb3c11ec258628d7a67.css integrity="sha256-gzC/MFI2KNAKur6tFtY6e1zXVwvUkByzwR7CWGKNemc=" rel="preload stylesheet" as=style><link rel=icon href=http://jeha00.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://jeha00.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://jeha00.github.io/favicon-32x32.png><link rel=apple-touch-icon href=http://jeha00.github.io/apple-touch-icon.png><link rel=mask-icon href=http://jeha00.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.101.0"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기"><meta property="og:description" content="uwsgi, nginx 를 연결했으니, R3에 연결하여 static file을 적용해본다."><meta property="og:type" content="article"><meta property="og:url" content="http://jeha00.github.io/post/django/deployment/deployment-with-nginx-uwsgi-ec2_3/"><meta property="og:image" content="http://jeha00.github.io/47"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-10-19T03:31:58+09:00"><meta property="article:modified_time" content="2022-10-19T03:31:58+09:00"><meta property="og:site_name" content="JeHa00 DevLog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://jeha00.github.io/47"><meta name=twitter:title content="Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기"><meta name=twitter:description content="uwsgi, nginx 를 연결했으니, R3에 연결하여 static file을 적용해본다."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://jeha00.github.io/post/"},{"@type":"ListItem","position":2,"name":"Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기","item":"http://jeha00.github.io/post/django/deployment/deployment-with-nginx-uwsgi-ec2_3/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기","name":"Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기","description":"uwsgi, nginx 를 연결했으니, R3에 연결하여 static file을 적용해본다.","keywords":["Django"],"articleBody":"0. Introduction 해당 강의는 러닝스푼즈 - 나노디그리 Python \u0026 Django backed course의 김형종 강사님의 django 강의를 학습한 내용입니다.\n만든 프로젝트를 EC2에 올리고, S3에는 STATIC 파일들을 저장하고, RDS를 연결해보는 실습을 해보고 나서 정리한 것을 올린다.\n실제 현업에서는 STATIC 파일을 올리는 방법들 중 S3를 사용하는 방식을 사용 한다고 한다.\n지난 배포 과정에서 nginx 와 uwsgi 를 연결하여 EC2 public IPv4 만 입력해도 장고 웹 애플리케이션이 돌아가도록 했다. 하지만, CSS 가 적용되지 않는 문제점이 있다. 이를 해결하고자 S3에 연결하는 과정을 진행해본다. 그 다음으로 동적 데이터 처리를 위해 RDS와도 연결해본다.\n1. Static file serving 3가지 방식으로 static file을 서빙해본다.\n이 3가지 방식을 경험해보면서 왜 S3를 현업에서 사용하는지 이해해보자.\n첫 번째 방법: ’location /static/’ 추가 경로: /etc/nginx/sites-enabled/default 명령어: sudo vi /etc/nginx/sites-enabled/default 위 경로 파일에 아래 내용을 추가한다. 1 2 3 4 5 6 location /static/ { alias /home/ubuntu/www/ls-django/static/; } # nginx를 수정하면 다시 reload를 반드시 해야 한다. $ sudo service nginx reload 의미: /static/ 이라는 url이 들어오면 alias로 가리키는 부분으로 이동해라.\n문제점: 이 방법을 사용하면 admin에 적용되는 css를 확인할 수가 없다.\n두 번째 방법: collectstatic 모든 static 파일을 public이라는 한 폴더 안에 모으기 때문에, 첫 번째 방법의 문제점을 해결할 수 있다. 하지만, 이 경우 public 폴더를 사용하기 위해서 location 설정을 바꿔야 한다.\n1. config/settings.py 에 아래 내용 추가하기 경로: www/ls-django 명령어: vi config/settings.py 1 2 3 4 5 6 # STATIC STATIC_URL = \"static/\" STATICFILES_DIRS = [BASE_DIR / \"static\"] # 위에 두 줄은 이미 입력되어 있을 것이다. 있다면 밑에 한 줄만 입력한다. STATIC_ROOT = os.path.join(BASE_DIR, \"public\") STATIC_URL: static resources를 접근하는 URL STATICFILES_DIRS: django project에서 사용하는 static resources 경로 지정 위에 STATIC_ROOT로 collectstatic 명령어를 통해 static resources가 모이는 위치 2. python manage.py collecstatic 실행 실행 결과 -139 static files copied to '/home/ubuntu/www/ls-django/public'. /home/ubuntu/www/ls-django/public 이 생긴다. 3. nginx.conf의 /static/ -\u003e /public/ 파일 경로: /etc/nginx/sites-enabled/default\n명령어: sudo vi /etc/nginx/sites-enabled/default\npython manage.py collectstatic을 실행한 결과, public이 생기면서 정적 파일들을 이 폴더로 모았기 때문에 아래 내용에서 /home/ubuntu/www/ls-django/static/을 /home/ubuntu/www/ls-django/public/으로 바꾼다.\n1 2 3 location /static/ { alias /home/ubuntu/www/ls-django/public/; } nginx를 수정했으므로, sudo service nginx reload를 실행하여 반영한다.\n문제점: 프로젝트 내부에 정적 파일들을 모아놓기 때문에, 서버 부하를 피할 수 없다.\n세 번째 방법: S3에 연결하기 두 번째 방법의 문제점을 해결하기 위해 내부가 아닌 외부 AWS S3에 모아놓은 정적 파일들을 올려서 서버 부하를 분산시킨다.\n1) AWS S3에서 Bucket 만들기 2) Django module 설치하기 경로: 프로젝트 내부\npip install boto3 실행\npip install django-storages 실행\nstorages는 settings.py 와 연관되어 있기 때문에, INSTALLED_APPS에 storages 등록한다.\n3) AWS IAM에서 다운 받은 key를 settings.py에 반영하기 먼저 아래 과정을 거친다.\nAWS IAM 들어가기 \u003e 왼쪽에 액세스 관리 \u003e 사용자 \u003e 사용자 추가 사용자 세부 정보 설정 \u003e 사용자 이름 입력 AWS 액세스 유형 선택 \u003e 액세스 키 - 프로그래밍 방식 액세스 선택 다음 권한 클릭 \u003e 권한 설정 \u003e 그룹에 사용자 추가 \u003e 그룹 생성 \u003e 그룹 이름 입력 \u003e 정책 이름 \u003e AmazonS3FullAccess 클릭 \u003e 그룹 생성 🔆실제 서비스에서는 AmazonS3FullAccess를 선택하지 않으므로, 나중에 조정해야 한다.\n다음: 태그 \u003e 다음: 검토 \u003e 사용자 만들기 를 거쳐서 총 5단계까지 진행한다. 5단계에서 .csv 다운로드 를 클릭하여 다운받는다. 다운받은 csv를 열어보면 secret access key를 가지고 있다. 위에 다운받은 key를 아래 settings.py 에 입력한다. AWS 설정값 구성을 settings.py에 추가하기\n1 2 3 4 5 6 7 8 9 10 11 12 # 경로: settings.py # 제일 아래에 추가한다. # 입력시 대괄호는 빼고 입력한다. AWS_ACCESS_KEY_ID = \"[액세스키]\" AWS_SECRET_ACCESS_KEY = \"[비밀 키]\" AWS_REGION = \"[리전명]\" AWS_STORAGE_BUCKET_NAME = \"[버킷명]\" AWS_S3_CUSTOM_DOMAIN = f\"{AWS_STORAGE_BUCKET_NAME}.s3.{AWS_REGION}.amazonaws.com\" AWS_DEFAULT_ACL = \"public-read\" DEFAULT_FILE_STORAGE = \"config.storages.S3DefaultStorage\" STATICFILES_STORAGE = \"config.storages.S3StaticStorage\" 액세스키, 비밀키는 csv에 존재한다. 버킷명과 리전명은 S3로 이동하여 확인한다. ap-northeast-2 맨 아래 DEFAULT_FILE_STORAG 와 STATICFILES_STORAGE 의 각 S3DefaultStorage , S3StaticStorage 는 밑에 config/storages.py 의 class를 의미한다. 4) config/storages.py 추가하기 config/storages.py는 위에 settings.py에 추가한 코드대로 config 밑에 추가한다.\n경로: config/storages.py\n1 2 3 4 5 6 7 from storages.backends.s3boto3 import S3Boto3Storage class S3DefaultStorage(S3Boto3Storage): location = \"media\" class S3StaticStorage(S3Boto3Storage): location = \"static\" 5) static directory 파일들을 S3로 옮기기 python manage.py collectstatic 실행하기\nconfig/settings.py의 AWS_STORAGE_BUCKET_NAME 을 AWS IAM의 사용자 이름과 착각하지 말기 6) nginx의 location url로 경로 바꾸기 다시 브라우저 화면의 inspector를 들어가서 css 파일 url을 보면 AWS S3 bucket으로 연결되지 않은 걸 확인할 수 있다.\n그 이유는 바로 /etc/nginx/sites-enabled/default 의 location /public/ url 안에 있는 경로 때문이다. 이를 S3 경로로 수정해야 한다.\n그러면 amazon S3 bucket 에 들어가면 static/ 이 존재한다. 그래서 각 파일을 클릭하여 들어가면 각 객체마다의 url 경로가 존재한다. 버킷의 url을 복사하는 방법\n버킷에 들어가서 static/ 왼쪽에 빈칸을 클릭하면 URL 복사가 활성화된다. 1 2 3 4 # 경로: /etc/nginx/sites-enabled/default location /static/ { alias. https://learningspoons-django-bucket1.s3.ap-northeast-2.amazonaws.com/static/; } 변경했으니 다시 reload 한다.\nsudo service nginx reload: nginx 재적용 하지만 그래도 css는 불려지지 않는다. 아래 명령어를 입력한 후, 다시 조회해보면 css가 불려질 것이다.\n1 2 3 $ uwsgi --ini .conf/uwsgi.ini $ sudo service nginx reload css 파일의 Request URL을 보면 다음과 같이 aws에서 오는 걸 확인할 수 있다.\n🔆 기타 개념: CloudFront\n인스타그램 같은 국제 서비스는 한국에서 미국으로 접속해야 한다. region과 여러 나라 간의 거리가 멀기 때문에, 스태틱 파일을 서빙하는게 오래 걸린다. 그래서 여러 중간 지점에 복사본(mirror image)을 저장하여 서빙 시간을 아낀다. S3를 본 딴 이미지가 여러 각 지역에 위치한다. 그래서 보다 더 빨리 서빙한다. CDN = 콘텐츠 전송 네트워크(Content Delivery Network) 로 옮겨서 응답시간을 개선. 지리적으로 분산된 서버의 네트워크 2. RDS 연결하기 RDS를 연결한 후, super user 계정을 생성하여 admin page에 들어가보자.\nadmin page에 들어가려는 이유는 이것으로 DB 연결 유무를 확인할 수 있다.\n❗️ 아래 연결 설정들은 단지 RDS를 연결해보자는 취지 에 맞게만 설정한 것이므로, 실제 프로젝트 시작 시에는 다를 수 있다.\n첫 번째, RDS DB 생성하기 AWS RDS 들어가기 -\u003e ‘데이터 베이스 생성하기’ 클릭\n데이터베이스 생성 방식 선택: ‘표준 생성’ 클릭\n엔진 옵션: PostegreSQL 클릭\n템플릿: 개발/테스트 클릭\n설정\n‘DB instance 식별자’ 에 이름 입력 ex) learningspoons ‘마스터 사용자 이름’에 이름 입력 ex) learningspoons 인스턴스 구성\n‘버스터블 클래스’ 선택 -\u003e ‘db.t3.micro’ 클릭 스토리지: 스토리지 자동 조정 체크 해제\n왜냐하면 지금 바로 필요하지 않기 때문 가용성 및 내구성: 기본값을 유지\n연결:\n‘퍼블릭 액세스’에서 ‘예’ 선택 ‘VPC 보안 그룹(방화벽)’ 에서 ‘기존 항목 선택’ 클릭 데이터베이스 인증:\n‘암호 인증’ 선택 모니터링: ‘성능 개선 도우미’에서 ‘성능 인사이트 켜기’ 체크 해제\n추가 구성:\n‘초기 데이터베이스 이름’ 작성하기 ex) postgres 두 번째, 인바운드 규칙 편집 AWS EC2에 들어가서 해당 인스턴스 선택\n왼쪽 ‘네트워크 및 보안’ 에 ‘보안 그룹’ 클릭\n1번 인스턴스의 보안그룹 선택 후, ‘인바운드 규칙 편집’ 클릭\n‘규칙 추가’ 클릭 -\u003e 유형: ‘postgresql’ 선택 -\u003e 소스: ‘Anywhere-IPv4` 선택\n❗️인바운드 규칙 미추가로 인한 Error 4번을 추가하지 않으면 나중에 python manage.py runserver를 실행할 때, 다음과 같은 안내문이 뜨면서 진행되지 않는다. 위 보안사항을 추가하면 자연스럽게 서버가 돌아간다.\n1 2 3 # ls-django.cvhmktue5rnw.ap-northeast-2.rds.amazonaws.com 는 생성한 RDS DB의 엔드포인트를 의미 Is the server running on host \"ls-django.cvhmktue5rnw.ap-northeast-2.rds.amazonaws.com\" (172.31.28.221) and accepting TCP/IP connections on port 5432? 세 번째, local django settings.py에 RDS정보 입력 기존에 있던 DATEBASES 내용을 다음과 같이 수정한다.\n해당 강의를 진행할 때는 local에서만 진행했지만, 나는 EC2 우분투 서버에서도 해본 결과 동일하게 진행하면 된다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 # config/settings.py DATABASES = { \"default\": { \"ENGINE\": \"django.db.backends.postgresql_psycopg2\", # 아래는 예시일 뿐, 리스트말고 문자열로 입력한다. “HOST\": [RDS 엔드포인트], \"NAME\": [DB 이름], \"PORT\": \"5432\", \"USER\": [마스터 사용자 이름], \"PASSWORD\": [비밀번호], } } 생성한 DB 인스턴스를 들어가서 클릭하여 ‘연결 \u0026 보안’ 탭에 들어가면 HOST가 존재한다. NAME, USER 는 “구성” 탭에 존재한다. 위 내용을 입력하고 runserver를 하면 ENGINE에서 psycopg2가 설치되지 않아 ModuleError가 발생된다.\n이를 해결하고자 psycopg2를 설치해보자.\n네 번째, psycopg2 설치하기 postgresql을 사용하기 위해서 psycopg2 를 설치해야 한다.\npsycopg2는 컴퓨터 OS마다, 버전마다 설치방법이 달라서 다양하게 시도해보았다.\nstackoverflow도 보고, github issue도 뒤져본 결과 맥북 에어 M1을 사용한다는 전제하에 다음 명령어를 입력하니 한 번에 해결되었다.\npip install psycopg2-binary==2.9.2 내가 시도해본 순서를 정리하여 아래에 기록한다.\n1 2 pip install psycopg2-binary wheel pip install psycopg2 위에 두 명령어 실행 후, python manage.py runserver를 돌릴 때 안되면 아래 명령어 실행하기\n1 2 3 4 5 6 7 8 9 10 11 # 아래 brew 명령어를 실행하기 위해서는 brew를 먼저 설치해야 한다. # 아래 두 명령어 실행 후, reinstall 명령어 안내가 뜨면 각각 다 실행하기 brew install libpq --build-from-source brew install postgresql openssl export LDFLAGS=\"-L/opt/homebrew/opt/openssl/lib\" export CPPFLAGS=\"-I/opt/homebrew/opt/openssl/include\" pip install psycopg2-binary --force-reinstall --no-cache-dir pip install psycopg2 --force-reinstall --no-cache-dir pip install --upgrade numpy 위 명령어들을 다 실행하고 runserver를 실행했을 때 psycopg2 module이 인식되지 않으면 pip install psycopg2-binary==2.9.2 을 실행해보자.\n다섯 번째, admin 들어가기 python manage.py createsuperuser를 실행 후, 어드민 로그인을 한다.\n로그인이 된다면 DB 연결이 잘 된 것이다.\nReference 러닝스푼즈 - 나노디그리 Python \u0026 Django backed course ","wordCount":"1348","inLanguage":"en","datePublished":"2022-10-19T03:31:58+09:00","dateModified":"2022-10-19T03:31:58+09:00","author":[{"@type":"Person","name":"Me"}],"mainEntityOfPage":{"@type":"WebPage","@id":"http://jeha00.github.io/post/django/deployment/deployment-with-nginx-uwsgi-ec2_3/"},"publisher":{"@type":"Organization","name":"Jeha DevLog","logo":{"@type":"ImageObject","url":"http://jeha00.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://jeha00.github.io/ accesskey=h title="@Jeha00 (Alt + H)">@Jeha00</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=http://jeha00.github.io/me/ title=About><span>About</span></a></li><li><a href=http://jeha00.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=http://jeha00.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=http://jeha00.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://jeha00.github.io/>Home</a>&nbsp;»&nbsp;<a href=http://jeha00.github.io/post/>Posts</a></div><h1 class=post-title>Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기</h1><div class=post-meta>Django&nbsp;·&nbsp;<span title='2022-10-19 03:31:58 +0900 KST'>October 19, 2022</span>&nbsp;·&nbsp;Me</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#0-introduction aria-label="0. Introduction">0. Introduction</a></li><li><a href=#1-static-file-serving aria-label="1. Static file serving">1. Static file serving</a><ul><li><a href=#%ec%b2%ab-%eb%b2%88%ec%a7%b8-%eb%b0%a9%eb%b2%95-location-static-%ec%b6%94%ea%b0%80 aria-label="첫 번째 방법: &amp;rsquo;location /static/&amp;rsquo; 추가">첫 번째 방법: &rsquo;location /static/&rsquo; 추가</a></li><li><a href=#%eb%91%90-%eb%b2%88%ec%a7%b8-%eb%b0%a9%eb%b2%95-collectstatic aria-label="두 번째 방법: collectstatic">두 번째 방법: collectstatic</a><ul><li><a href=#1-configsettingspy-%ec%97%90-%ec%95%84%eb%9e%98-%eb%82%b4%ec%9a%a9-%ec%b6%94%ea%b0%80%ed%95%98%ea%b8%b0 aria-label="1. config/settings.py 에 아래 내용 추가하기">1. config/settings.py 에 아래 내용 추가하기</a></li><li><a href=#2-python-managepy-collecstatic-%ec%8b%a4%ed%96%89 aria-label="2. python manage.py collecstatic 실행">2. python manage.py collecstatic 실행</a></li><li><a href=#3-nginxconf%ec%9d%98-static---public aria-label="3. nginx.conf의 /static/ -&amp;gt; /public/">3. nginx.conf의 /static/ -> /public/</a></li></ul></li><li><a href=#%ec%84%b8-%eb%b2%88%ec%a7%b8-%eb%b0%a9%eb%b2%95-s3%ec%97%90-%ec%97%b0%ea%b2%b0%ed%95%98%ea%b8%b0 aria-label="세 번째 방법: S3에 연결하기">세 번째 방법: S3에 연결하기</a><ul><li><a href=#1-aws-s3%ec%97%90%ec%84%9c-bucket-%eb%a7%8c%eb%93%a4%ea%b8%b0 aria-label="1) AWS S3에서 Bucket 만들기">1) AWS S3에서 Bucket 만들기</a></li><li><a href=#2-django-module-%ec%84%a4%ec%b9%98%ed%95%98%ea%b8%b0 aria-label="2) Django module 설치하기">2) Django module 설치하기</a></li><li><a href=#3-aws-iam%ec%97%90%ec%84%9c-%eb%8b%a4%ec%9a%b4-%eb%b0%9b%ec%9d%80-key%eb%a5%bc-settingspy%ec%97%90-%eb%b0%98%ec%98%81%ed%95%98%ea%b8%b0 aria-label="3) AWS IAM에서 다운 받은 key를 settings.py에 반영하기">3) AWS IAM에서 다운 받은 key를 settings.py에 반영하기</a></li><li><a href=#4-configstoragespy-%ec%b6%94%ea%b0%80%ed%95%98%ea%b8%b0 aria-label="4) config/storages.py 추가하기">4) config/storages.py 추가하기</a></li><li><a href=#5-static-directory-%ed%8c%8c%ec%9d%bc%eb%93%a4%ec%9d%84-s3%eb%a1%9c-%ec%98%ae%ea%b8%b0%ea%b8%b0 aria-label="5) static directory 파일들을 S3로 옮기기">5) static directory 파일들을 S3로 옮기기</a></li><li><a href=#6-nginx%ec%9d%98-location-url%eb%a1%9c-%ea%b2%bd%eb%a1%9c-%eb%b0%94%ea%be%b8%ea%b8%b0 aria-label="6) nginx의 location url로 경로 바꾸기">6) nginx의 location url로 경로 바꾸기</a></li></ul></li></ul></li><li><a href=#2-rds-%ec%97%b0%ea%b2%b0%ed%95%98%ea%b8%b0 aria-label="2. RDS 연결하기">2. RDS 연결하기</a><ul><li><a href=#%ec%b2%ab-%eb%b2%88%ec%a7%b8-rds-db-%ec%83%9d%ec%84%b1%ed%95%98%ea%b8%b0 aria-label="첫 번째, RDS DB 생성하기">첫 번째, RDS DB 생성하기</a></li><li><a href=#%eb%91%90-%eb%b2%88%ec%a7%b8-%ec%9d%b8%eb%b0%94%ec%9a%b4%eb%93%9c-%ea%b7%9c%ec%b9%99-%ed%8e%b8%ec%a7%91 aria-label="두 번째, 인바운드 규칙 편집">두 번째, 인바운드 규칙 편집</a></li><li><a href=#%ec%9d%b8%eb%b0%94%ec%9a%b4%eb%93%9c-%ea%b7%9c%ec%b9%99-%eb%af%b8%ec%b6%94%ea%b0%80%eb%a1%9c-%ec%9d%b8%ed%95%9c-error aria-label="❗️인바운드 규칙 미추가로 인한 Error">❗️인바운드 규칙 미추가로 인한 Error</a></li><li><a href=#%ec%84%b8-%eb%b2%88%ec%a7%b8-local-django-settingspy%ec%97%90-rds%ec%a0%95%eb%b3%b4-%ec%9e%85%eb%a0%a5 aria-label="세 번째, local django settings.py에 RDS정보 입력">세 번째, local django settings.py에 RDS정보 입력</a></li><li><a href=#%eb%84%a4-%eb%b2%88%ec%a7%b8-psycopg2-%ec%84%a4%ec%b9%98%ed%95%98%ea%b8%b0 aria-label="네 번째, psycopg2 설치하기">네 번째, psycopg2 설치하기</a></li><li><a href=#%eb%8b%a4%ec%84%af-%eb%b2%88%ec%a7%b8-admin-%eb%93%a4%ec%96%b4%ea%b0%80%ea%b8%b0 aria-label="다섯 번째, admin 들어가기">다섯 번째, admin 들어가기</a></li></ul></li><li><a href=#reference aria-label=Reference>Reference</a></li></ul></div></details></div><div class=post-content><h1 id=0-introduction>0. Introduction<a hidden class=anchor aria-hidden=true href=#0-introduction>#</a></h1><ul><li><p>해당 강의는 <a href=https://learningspoons.com/course/detail/django-backend/>러닝스푼즈 - 나노디그리 Python & Django backed course</a>의 김형종 강사님의 django 강의를 학습한 내용입니다.</p></li><li><p>만든 프로젝트를 EC2에 올리고, S3에는 STATIC 파일들을 저장하고, RDS를 연결해보는 실습을 해보고 나서 정리한 것을 올린다.</p></li><li><p>실제 현업에서는 <strong>STATIC 파일을 올리는 방법들 중 S3를 사용하는 방식을 사용</strong> 한다고 한다.</p></li><li><p>지난 배포 과정에서 nginx 와 uwsgi 를 연결하여 EC2 public IPv4 만 입력해도 장고 웹 애플리케이션이 돌아가도록 했다. 하지만, <strong>CSS</strong> 가 적용되지 않는 문제점이 있다. 이를 해결하고자 S3에 연결하는 과정을 진행해본다. 그 다음으로 동적 데이터 처리를 위해 RDS와도 연결해본다.</p></li></ul><p> </p><hr><h1 id=1-static-file-serving>1. Static file serving<a hidden class=anchor aria-hidden=true href=#1-static-file-serving>#</a></h1><p>3가지 방식으로 static file을 서빙해본다.</p><p>이 3가지 방식을 경험해보면서 왜 S3를 현업에서 사용하는지 이해해보자.</p><h2 id=첫-번째-방법-location-static-추가>첫 번째 방법: &rsquo;location /static/&rsquo; 추가<a hidden class=anchor aria-hidden=true href=#첫-번째-방법-location-static-추가>#</a></h2><ul><li>경로: <code>/etc/nginx/sites-enabled/default</code></li><li>명령어: <code>sudo vi /etc/nginx/sites-enabled/default</code></li><li>위 경로 파일에 아래 내용을 추가한다.</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>location /static/ { </span>
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>alias   /home/ubuntu/www/ls-django/static/;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># nginx를 수정하면 다시 reload를 반드시 해야 한다.</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ sudo service nginx reload</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><p>의미: /static/ 이라는 url이 들어오면 alias로 가리키는 부분으로 이동해라.</p></li><li><p>문제점: 이 방법을 사용하면 admin에 적용되는 css를 확인할 수가 없다.</p></li></ul><p> </p><h2 id=두-번째-방법-collectstatic>두 번째 방법: collectstatic<a hidden class=anchor aria-hidden=true href=#두-번째-방법-collectstatic>#</a></h2><p>모든 static 파일을 public이라는 한 폴더 안에 모으기 때문에, 첫 번째 방법의 문제점을 해결할 수 있다. 하지만, 이 경우 public 폴더를 사용하기 위해서 location 설정을 바꿔야 한다.</p><h3 id=1-configsettingspy-에-아래-내용-추가하기>1. config/settings.py 에 아래 내용 추가하기<a hidden class=anchor aria-hidden=true href=#1-configsettingspy-에-아래-내용-추가하기>#</a></h3><ul><li>경로: <code>www/ls-django</code></li><li>명령어: <code>vi config/settings.py</code></li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#75715e># STATIC</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>STATIC_URL = &#34;static/&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>STATICFILES_DIRS = [BASE_DIR / &#34;static&#34;]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 위에 두 줄은 이미 입력되어 있을 것이다. 있다면 밑에 한 줄만 입력한다.</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>STATIC_ROOT = os.path.join(BASE_DIR, &#34;public&#34;)</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>STATIC_URL: static resources를 접근하는 URL</li><li>STATICFILES_DIRS: django project에서 사용하는 static resources 경로 지정</li><li>위에 STATIC_ROOT로 collectstatic 명령어를 통해 static resources가 모이는 위치</li></ul><h3 id=2-python-managepy-collecstatic-실행>2. python manage.py collecstatic 실행<a hidden class=anchor aria-hidden=true href=#2-python-managepy-collecstatic-실행>#</a></h3><ul><li>실행 결과
-<code>139 static files copied to '/home/ubuntu/www/ls-django/public'.</code><ul><li><code>/home/ubuntu/www/ls-django/public</code> 이 생긴다.</li></ul></li></ul><h3 id=3-nginxconf의-static---public>3. nginx.conf의 /static/ -> /public/<a hidden class=anchor aria-hidden=true href=#3-nginxconf의-static---public>#</a></h3><ul><li><p>파일 경로: /etc/nginx/sites-enabled/default</p></li><li><p>명령어: <code>sudo vi /etc/nginx/sites-enabled/default</code></p></li><li><p><code>python manage.py collectstatic</code>을 실행한 결과, public이 생기면서 정적 파일들을 이 폴더로 모았기 때문에 아래 내용에서 <code>/home/ubuntu/www/ls-django/static/</code>을 <code>/home/ubuntu/www/ls-django/public/</code>으로 바꾼다.</p></li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>location /static/ { </span>
</span></span><span style=display:flex><span>				<span style=color:#ae81ff>alias /home/ubuntu/www/ls-django/public/;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><ul><li><p>nginx를 수정했으므로, <code>sudo service nginx reload</code>를 실행하여 반영한다.</p></li><li><p>문제점: 프로젝트 내부에 정적 파일들을 모아놓기 때문에, 서버 부하를 피할 수 없다.</p></li></ul><p> </p><h2 id=세-번째-방법-s3에-연결하기>세 번째 방법: S3에 연결하기<a hidden class=anchor aria-hidden=true href=#세-번째-방법-s3에-연결하기>#</a></h2><p>두 번째 방법의 문제점을 해결하기 위해 내부가 아닌 외부 AWS S3에 모아놓은 정적 파일들을 올려서 서버 부하를 분산시킨다.</p><h3 id=1-aws-s3에서-bucket-만들기>1) AWS S3에서 Bucket 만들기<a hidden class=anchor aria-hidden=true href=#1-aws-s3에서-bucket-만들기>#</a></h3><h3 id=2-django-module-설치하기>2) Django module 설치하기<a hidden class=anchor aria-hidden=true href=#2-django-module-설치하기>#</a></h3><p>경로: 프로젝트 내부</p><ol><li><p><code>pip install boto3</code> 실행</p></li><li><p><code>pip install django-storages</code> 실행</p></li></ol><p>storages는 settings.py 와 연관되어 있기 때문에, INSTALLED_APPS에 storages 등록한다.</p><h3 id=3-aws-iam에서-다운-받은-key를-settingspy에-반영하기>3) AWS IAM에서 다운 받은 key를 settings.py에 반영하기<a hidden class=anchor aria-hidden=true href=#3-aws-iam에서-다운-받은-key를-settingspy에-반영하기>#</a></h3><p>먼저 아래 과정을 거친다.</p><ol><li>AWS IAM 들어가기 > 왼쪽에 액세스 관리 > 사용자 > 사용자 추가</li><li>사용자 세부 정보 설정 > 사용자 이름 입력</li><li>AWS 액세스 유형 선택 > 액세스 키 - 프로그래밍 방식 액세스 선택</li><li>다음 권한 클릭 > 권한 설정 > 그룹에 사용자 추가 > 그룹 생성 > 그룹 이름 입력 > 정책 이름 > AmazonS3FullAccess 클릭 > 그룹 생성</li></ol><p>🔆실제 서비스에서는 AmazonS3FullAccess를 선택하지 않으므로, 나중에 조정해야 한다.</p><ol start=5><li>다음: 태그 > 다음: 검토 > 사용자 만들기 를 거쳐서 총 5단계까지 진행한다.<ol><li>5단계에서 <code>.csv 다운로드</code> 를 클릭하여 다운받는다.</li><li>다운받은 csv를 열어보면 secret access key를 가지고 있다.</li></ol></li><li>위에 다운받은 key를 아래 <code>settings.py</code> 에 입력한다.</li></ol><p>AWS 설정값 구성을 settings.py에 추가하기</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#75715e># 경로: settings.py </span>
</span></span><span style=display:flex><span><span style=color:#75715e># 제일 아래에 추가한다. </span>
</span></span><span style=display:flex><span><span style=color:#75715e># 입력시 대괄호는 빼고 입력한다.</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>AWS_ACCESS_KEY_ID = &#34;[액세스키]&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>AWS_SECRET_ACCESS_KEY = &#34;[비밀 키]&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>AWS_REGION = &#34;[리전명]&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>AWS_STORAGE_BUCKET_NAME = &#34;[버킷명]&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>AWS_S3_CUSTOM_DOMAIN = f&#34;{AWS_STORAGE_BUCKET_NAME}.s3.{AWS_REGION}.amazonaws.com&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>AWS_DEFAULT_ACL = &#34;public-read&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>DEFAULT_FILE_STORAGE = &#34;config.storages.S3DefaultStorage&#34; </span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>STATICFILES_STORAGE = &#34;config.storages.S3StaticStorage&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>액세스키, 비밀키는 csv에 존재한다.</li><li>버킷명과 리전명은 S3로 이동하여 확인한다.<ul><li>ap-northeast-2</li></ul></li><li>맨 아래 <code>DEFAULT_FILE_STORAG</code> 와 <code>STATICFILES_STORAGE</code> 의 각 <code>S3DefaultStorage</code> , <code>S3StaticStorage</code> 는 밑에 <code>config/storages.py</code> 의 class를 의미한다.</li></ul><h3 id=4-configstoragespy-추가하기>4) config/storages.py 추가하기<a hidden class=anchor aria-hidden=true href=#4-configstoragespy-추가하기>#</a></h3><ul><li><p><code>config/storages.py</code>는 위에 settings.py에 추가한 코드대로 config 밑에 추가한다.</p></li><li><p>경로: config/storages.py</p></li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>from storages.backends.s3boto3 import S3Boto3Storage</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>class S3DefaultStorage(S3Boto3Storage)</span>: 
</span></span><span style=display:flex><span>		<span style=color:#ae81ff>location = &#34;media&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>class S3StaticStorage(S3Boto3Storage)</span>: 
</span></span><span style=display:flex><span>		<span style=color:#ae81ff>location = &#34;static&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=5-static-directory-파일들을-s3로-옮기기>5) static directory 파일들을 S3로 옮기기<a hidden class=anchor aria-hidden=true href=#5-static-directory-파일들을-s3로-옮기기>#</a></h3><p><code>python manage.py collectstatic</code> 실행하기</p><ul><li><code>config/settings.py</code>의 <code>AWS_STORAGE_BUCKET_NAME</code> 을 AWS IAM의 사용자 이름과 착각하지 말기</li></ul><h3 id=6-nginx의-location-url로-경로-바꾸기>6) nginx의 location url로 경로 바꾸기<a hidden class=anchor aria-hidden=true href=#6-nginx의-location-url로-경로-바꾸기>#</a></h3><ul><li><p>다시 브라우저 화면의 inspector를 들어가서 css 파일 url을 보면 AWS S3 bucket으로 연결되지 않은 걸 확인할 수 있다.</p></li><li><p>그 이유는 바로 <code>/etc/nginx/sites-enabled/default</code> 의 location <code>/public/</code> url 안에 있는 경로 때문이다. 이를 S3 경로로 수정해야 한다.</p><ul><li>그러면 amazon S3 bucket 에 들어가면 <code>static/</code> 이 존재한다. 그래서 각 파일을 클릭하여 들어가면 각 객체마다의 url 경로가 존재한다.</li></ul></li><li><p>버킷의 url을 복사하는 방법</p><ul><li>버킷에 들어가서 <code>static/</code> 왼쪽에 빈칸을 클릭하면 <code>URL 복사</code>가 활성화된다.</li></ul></li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># 경로: /etc/nginx/sites-enabled/default</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>location /static/ {</span>
</span></span><span style=display:flex><span>				<span style=color:#ae81ff>alias.  https://learningspoons-django-bucket1.s3.ap-northeast-2.amazonaws.com/static/;</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>변경했으니 다시 reload 한다.</p><ul><li><code>sudo service nginx reload</code>: nginx 재적용<ul><li>하지만 그래도 css는 불려지지 않는다.</li></ul></li></ul><p>아래 명령어를 입력한 후, 다시 조회해보면 css가 불려질 것이다.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>$ uwsgi --ini .conf/uwsgi.ini</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ sudo service nginx reload</span>
</span></span></code></pre></td></tr></table></div></div><p>css 파일의 Request URL을 보면 다음과 같이 aws에서 오는 걸 확인할 수 있다.</p><p>🔆 기타 개념: CloudFront</p><ul><li>인스타그램 같은 국제 서비스는 한국에서 미국으로 접속해야 한다. region과 여러 나라 간의 거리가 멀기 때문에, 스태틱 파일을 서빙하는게 오래 걸린다. 그래서 여러 중간 지점에 복사본(mirror image)을 저장하여 서빙 시간을 아낀다.</li><li>S3를 본 딴 이미지가 여러 각 지역에 위치한다. 그래서 보다 더 빨리 서빙한다.</li><li>CDN = 콘텐츠 전송 네트워크(Content Delivery Network) 로 옮겨서 응답시간을 개선. 지리적으로 분산된 서버의 네트워크</li></ul><p> </p><hr><h1 id=2-rds-연결하기>2. RDS 연결하기<a hidden class=anchor aria-hidden=true href=#2-rds-연결하기>#</a></h1><p>RDS를 연결한 후, super user 계정을 생성하여 admin page에 들어가보자.</p><p>admin page에 들어가려는 이유는 이것으로 DB 연결 유무를 확인할 수 있다.</p><p>❗️ 아래 연결 설정들은 단지 <strong>RDS를 연결해보자는 취지</strong> 에 맞게만 설정한 것이므로, 실제 프로젝트 시작 시에는 다를 수 있다.</p><h2 id=첫-번째-rds-db-생성하기>첫 번째, RDS DB 생성하기<a hidden class=anchor aria-hidden=true href=#첫-번째-rds-db-생성하기>#</a></h2><ol><li><p>AWS RDS 들어가기 -> &lsquo;데이터 베이스 생성하기&rsquo; 클릭</p></li><li><p>데이터베이스 생성 방식 선택: &lsquo;표준 생성&rsquo; 클릭</p></li><li><p>엔진 옵션: PostegreSQL 클릭</p></li><li><p>템플릿: 개발/테스트 클릭</p></li><li><p>설정</p><ul><li>&lsquo;DB instance 식별자&rsquo; 에 이름 입력<ul><li>ex) learningspoons</li></ul></li><li>&lsquo;마스터 사용자 이름&rsquo;에 이름 입력<ul><li>ex) learningspoons</li></ul></li></ul></li><li><p>인스턴스 구성</p><ul><li>&lsquo;버스터블 클래스&rsquo; 선택 -> &lsquo;db.t3.micro&rsquo; 클릭</li></ul></li><li><p>스토리지: 스토리지 자동 조정 체크 해제</p><ul><li>왜냐하면 지금 바로 필요하지 않기 때문</li></ul></li><li><p>가용성 및 내구성: 기본값을 유지</p></li><li><p>연결:</p><ul><li>&lsquo;퍼블릭 액세스&rsquo;에서 &lsquo;예&rsquo; 선택</li><li>&lsquo;VPC 보안 그룹(방화벽)&rsquo; 에서 &lsquo;기존 항목 선택&rsquo; 클릭</li></ul></li><li><p>데이터베이스 인증:</p><ul><li>&lsquo;암호 인증&rsquo; 선택</li></ul></li><li><p>모니터링: &lsquo;성능 개선 도우미&rsquo;에서 &lsquo;성능 인사이트 켜기&rsquo; 체크 해제</p></li><li><p>추가 구성:</p><ul><li>&lsquo;초기 데이터베이스 이름&rsquo; 작성하기<ul><li>ex) postgres</li></ul></li></ul></li></ol><p> </p><h2 id=두-번째-인바운드-규칙-편집>두 번째, 인바운드 규칙 편집<a hidden class=anchor aria-hidden=true href=#두-번째-인바운드-규칙-편집>#</a></h2><ol><li><p>AWS EC2에 들어가서 해당 인스턴스 선택</p></li><li><p>왼쪽 &lsquo;네트워크 및 보안&rsquo; 에 &lsquo;보안 그룹&rsquo; 클릭</p></li><li><p>1번 인스턴스의 보안그룹 선택 후, &lsquo;인바운드 규칙 편집&rsquo; 클릭</p></li><li><p>&lsquo;규칙 추가&rsquo; 클릭 -> 유형: &lsquo;postgresql&rsquo; 선택 -> 소스: &lsquo;Anywhere-IPv4` 선택</p></li></ol><h2 id=인바운드-규칙-미추가로-인한-error>❗️인바운드 규칙 미추가로 인한 Error<a hidden class=anchor aria-hidden=true href=#인바운드-규칙-미추가로-인한-error>#</a></h2><p>4번을 추가하지 않으면 나중에 <code>python manage.py runserver</code>를 실행할 때, 다음과 같은 안내문이 뜨면서 진행되지 않는다. 위 보안사항을 추가하면 자연스럽게 서버가 돌아간다.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#75715e># ls-django.cvhmktue5rnw.ap-northeast-2.rds.amazonaws.com 는 생성한 RDS DB의 엔드포인트를 의미</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Is the server running on host &#34;ls-django.cvhmktue5rnw.ap-northeast-2.rds.amazonaws.com&#34; </span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>(172.31.28.221) and accepting TCP/IP connections on port 5432?</span>
</span></span></code></pre></td></tr></table></div></div><p> </p><h2 id=세-번째-local-django-settingspy에-rds정보-입력>세 번째, local django settings.py에 RDS정보 입력<a hidden class=anchor aria-hidden=true href=#세-번째-local-django-settingspy에-rds정보-입력>#</a></h2><blockquote><p><strong><em>기존에 있던 DATEBASES 내용을 다음과 같이 수정한다.</em></strong></p></blockquote><p>해당 강의를 진행할 때는 local에서만 진행했지만, 나는 EC2 우분투 서버에서도 해본 결과 동일하게 진행하면 된다.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># config/settings.py</span>
</span></span><span style=display:flex><span>DATABASES <span style=color:#f92672>=</span> { 
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;default&#34;</span>: {
</span></span><span style=display:flex><span>       <span style=color:#e6db74>&#34;ENGINE&#34;</span>: <span style=color:#e6db74>&#34;django.db.backends.postgresql_psycopg2&#34;</span>,     
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#75715e># 아래는 예시일 뿐, 리스트말고 문자열로 입력한다.</span>
</span></span><span style=display:flex><span>        <span style=color:#960050;background-color:#1e0010>“</span>HOST<span style=color:#e6db74>&#34;: [RDS 엔드포인트],</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;NAME&#34;</span>: [DB 이름], 
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;PORT&#34;</span>: <span style=color:#e6db74>&#34;5432&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;USER&#34;</span>: [마스터 사용자 이름],
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;PASSWORD&#34;</span>: [비밀번호], 
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><ul><li>생성한 DB 인스턴스를 들어가서 클릭하여 ‘연결 & 보안’ 탭에 들어가면 HOST가 존재한다.</li><li>NAME, USER 는 “구성” 탭에 존재한다.</li></ul><p>위 내용을 입력하고 <code>runserver</code>를 하면 <code>ENGINE</code>에서 <code>psycopg2</code>가 설치되지 않아 ModuleError가 발생된다.</p><p>이를 해결하고자 psycopg2를 설치해보자.</p><p> </p><h2 id=네-번째-psycopg2-설치하기>네 번째, psycopg2 설치하기<a hidden class=anchor aria-hidden=true href=#네-번째-psycopg2-설치하기>#</a></h2><p>postgresql을 사용하기 위해서 psycopg2 를 설치해야 한다.</p><p>psycopg2는 컴퓨터 OS마다, 버전마다 설치방법이 달라서 다양하게 시도해보았다.</p><p>stackoverflow도 보고, github issue도 뒤져본 결과 맥북 에어 M1을 사용한다는 전제하에 다음 명령어를 입력하니 한 번에 해결되었다.</p><ul><li><code>pip install psycopg2-binary==2.9.2</code></li></ul><p>내가 시도해본 순서를 정리하여 아래에 기록한다.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>pip install psycopg2-binary wheel</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>pip install psycopg2 </span>
</span></span></code></pre></td></tr></table></div></div><p>위에 두 명령어 실행 후, python manage.py runserver를 돌릴 때 안되면 아래 명령어 실행하기</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#75715e># 아래 brew 명령어를 실행하기 위해서는 brew를 먼저 설치해야 한다. </span>
</span></span><span style=display:flex><span><span style=color:#75715e># 아래 두 명령어 실행 후, reinstall 명령어 안내가 뜨면 각각 다 실행하기</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>brew install libpq --build-from-source</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>brew install postgresql openssl</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>export LDFLAGS=&#34;-L/opt/homebrew/opt/openssl/lib&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>export CPPFLAGS=&#34;-I/opt/homebrew/opt/openssl/include&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>pip install psycopg2-binary --force-reinstall --no-cache-dir</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>pip install psycopg2 --force-reinstall --no-cache-dir</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>pip install --upgrade numpy</span>
</span></span></code></pre></td></tr></table></div></div><p>위 명령어들을 다 실행하고 <code>runserver</code>를 실행했을 때 psycopg2 module이 인식되지 않으면 <code>pip install psycopg2-binary==2.9.2</code> 을 실행해보자.</p><p> </p><h2 id=다섯-번째-admin-들어가기>다섯 번째, admin 들어가기<a hidden class=anchor aria-hidden=true href=#다섯-번째-admin-들어가기>#</a></h2><p><code>python manage.py createsuperuser</code>를 실행 후, 어드민 로그인을 한다.</p><p>로그인이 된다면 DB 연결이 잘 된 것이다.</p><p> </p><hr><h1 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h1><ul><li><a href=https://learningspoons.com/course/detail/django-backend/>러닝스푼즈 - 나노디그리 Python & Django backed course</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://jeha00.github.io/tags/django/>Django</a></li></ul><nav class=paginav><a class=prev href=http://jeha00.github.io/post/django/deployment/deployment-with-nginx-uwsgi-ec2_4/><span class=title>« Prev Page</span><br><span>Django study: nginx와 uwsgi를 사용한 django application deployment 04 - DB 나누기</span></a>
<a class=next href=http://jeha00.github.io/post/bookstudy/pythoncleancode/chapter01_errorandasking/><span class=title>Next Page »</span><br><span>클린 코드, 이제는 파이썬이다: error and question</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기 on twitter" href="https://twitter.com/intent/tweet/?text=Django%20study%3a%20nginx%ec%99%80%20uwsgi%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%9c%20django%20application%20deployment%2003%20-%20static%20file%20%ec%a0%81%ec%9a%a9%ed%95%98%ea%b8%b0&url=http%3a%2f%2fjeha00.github.io%2fpost%2fdjango%2fdeployment%2fdeployment-with-nginx-uwsgi-ec2_3%2f&hashtags=Django"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fjeha00.github.io%2fpost%2fdjango%2fdeployment%2fdeployment-with-nginx-uwsgi-ec2_3%2f&title=Django%20study%3a%20nginx%ec%99%80%20uwsgi%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%9c%20django%20application%20deployment%2003%20-%20static%20file%20%ec%a0%81%ec%9a%a9%ed%95%98%ea%b8%b0&summary=Django%20study%3a%20nginx%ec%99%80%20uwsgi%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%9c%20django%20application%20deployment%2003%20-%20static%20file%20%ec%a0%81%ec%9a%a9%ed%95%98%ea%b8%b0&source=http%3a%2f%2fjeha00.github.io%2fpost%2fdjango%2fdeployment%2fdeployment-with-nginx-uwsgi-ec2_3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기 on reddit" href="https://reddit.com/submit?url=http%3a%2f%2fjeha00.github.io%2fpost%2fdjango%2fdeployment%2fdeployment-with-nginx-uwsgi-ec2_3%2f&title=Django%20study%3a%20nginx%ec%99%80%20uwsgi%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%9c%20django%20application%20deployment%2003%20-%20static%20file%20%ec%a0%81%ec%9a%a9%ed%95%98%ea%b8%b0"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기 on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2fjeha00.github.io%2fpost%2fdjango%2fdeployment%2fdeployment-with-nginx-uwsgi-ec2_3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기 on whatsapp" href="https://api.whatsapp.com/send?text=Django%20study%3a%20nginx%ec%99%80%20uwsgi%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%9c%20django%20application%20deployment%2003%20-%20static%20file%20%ec%a0%81%ec%9a%a9%ed%95%98%ea%b8%b0%20-%20http%3a%2f%2fjeha00.github.io%2fpost%2fdjango%2fdeployment%2fdeployment-with-nginx-uwsgi-ec2_3%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Django study: nginx와 uwsgi를 사용한 django application deployment 03 - static file 적용하기 on telegram" href="https://telegram.me/share/url?text=Django%20study%3a%20nginx%ec%99%80%20uwsgi%eb%a5%bc%20%ec%82%ac%ec%9a%a9%ed%95%9c%20django%20application%20deployment%2003%20-%20static%20file%20%ec%a0%81%ec%9a%a9%ed%95%98%ea%b8%b0&url=http%3a%2f%2fjeha00.github.io%2fpost%2fdjango%2fdeployment%2fdeployment-with-nginx-uwsgi-ec2_3%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://jeha00.github.io/>Jeha DevLog</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>